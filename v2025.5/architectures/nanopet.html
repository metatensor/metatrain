<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="NativePET (experimental)" href="nativepet.html" /><link rel="prev" title="GAP" href="gap.html" />

    <link rel="shortcut icon" href="../_static/metatrain-64.png"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>NanoPET (experimental) - metatrain 2025.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">metatrain 2025.5 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/images/metatrain.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/images/metatrain-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Getting started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html#shell-completion">Shell Completion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/usage.html">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/custom_dataset_conf.html">Customize a Dataset Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/advanced_base_config.html">Advanced Base Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/override.html">Override Architecture’s Default Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/checkpoints.html">Checkpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/units.html">Units</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Available Architectures</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Available Architectures</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gap.html">GAP</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">NanoPET (experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="nativepet.html">NativePET (experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="pet.html">PET</a></li>
<li class="toctree-l2"><a class="reference internal" href="soap-bpnn.html">SOAP-BPNN</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/ase/run_ase.html">Running molecular dynamics with ASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/zbl/dimers.html">Training a model with ZBL corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/programmatic/llpr/llpr.html">Computing LLPR uncertainties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/programmatic/use_architectures_outside/use_outside.html">Using metatrain architectures outside of metatrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/programmatic/disk_dataset/disk_dataset.html">Saving a disk dataset</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced-concepts/index.html">Advanced concepts</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Advanced concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/output-naming.html">Output naming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/auxiliary-outputs.html">Auxiliary outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/multi-gpu.html">Multi-GPU training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/auto-restarting.html">Automatic restarting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/fine-tuning.html">Fine-tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/fitting-generic-targets.html">Fitting generic targets</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dev-docs/index.html">Developer documentation</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Developer documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev-docs/getting-started.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev-docs/architecture-life-cycle.html">Life Cycle of an Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev-docs/new-architecture.html">Adding a new architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev-docs/dataset-information.html">Dataset Information</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dev-docs/cli/index.html">CLI API</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of CLI API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/cli/train.html">Train</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/cli/eval.html">Eval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/cli/export.html">Export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/cli/formatter.html">Formatter</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dev-docs/utils/index.html">Utility API</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Utility API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../dev-docs/utils/additive/index.html">Additive models</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Additive models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/additive/remove_additive.html">Removing additive contributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/additive/composition.html">Composition model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/additive/zbl.html">ZBL short-range potential</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../dev-docs/utils/data/index.html">Data</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Data</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/data/combine_dataloaders.html">Combining dataloaders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/data/dataset.html">Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/data/get_dataset.html">Reading a dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/data/readers.html">Readers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/data/writers.html">Target data Writers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev-docs/utils/data/systems_to_ase.html">Converting Systems to ASE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/architectures.html">Architectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/devices.html">Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/dtype.html">Dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/errors.html">Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/evaluate_model.html">Evaluating a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/external_naming.html">External Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/io.html">IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/jsonschema.html">Jsonschema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/logging.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/long_range.html">Long-range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/loss.html">Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/metrics.html">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/neighbor_lists.html">Neighbor lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/omegaconf.html">Custom omegaconf functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/output_gradient.html">Output gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/per_atom.html">Averaging predictions per atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/scaler.html">Scaler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/sum_over_atoms.html">Summing over atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/transfer.html">Data type and device transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev-docs/utils/units.html">Unit handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev-docs/changelog.html">Changelog</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/architectures/nanopet.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="nanopet-experimental">
<span id="architecture-nanopet"></span><h1>NanoPET (experimental)<a class="headerlink" href="#nanopet-experimental" title="Link to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>experimental model</strong>. You should not use it for anything important.</p>
</div>
<p>This is a more user-friendly re-implementation of the original
PET <a class="footnote-reference brackets" href="#footcite-pozdnyakov-smooth-2023" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> (which lives in <a class="reference external" href="https://github.com/spozdn/pet">https://github.com/spozdn/pet</a>),
with slightly improved training and evaluation speed.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>To install the package, you can run the following command in the root
directory of the repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>metatrain<span class="o">[</span>nanopet<span class="o">]</span>
</pre></div>
</div>
<p>This will install the package with the nanoPET dependencies.</p>
</section>
<section id="default-hyperparameters">
<h2>Default Hyperparameters<a class="headerlink" href="#default-hyperparameters" title="Link to this heading">¶</a></h2>
<p>The default hyperparameters for the nanoPET model are:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">architecture</span><span class="p">:</span>

<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">experimental.nanopet</span>

<span class="w">  </span><span class="nt">model</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cutoff</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5.0</span>
<span class="w">    </span><span class="nt">cutoff_width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
<span class="w">    </span><span class="nt">d_pet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">128</span>
<span class="w">    </span><span class="nt">num_heads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">num_attention_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">num_gnn_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">heads</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">zbl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">long_range</span><span class="p">:</span><span class="w"> </span>
<span class="w">      </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">use_ewald</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">smearing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.4</span>
<span class="w">      </span><span class="nt">kspace_resolution</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.33</span>
<span class="w">      </span><span class="nt">interpolation_nodes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>

<span class="w">  </span><span class="nt">training</span><span class="p">:</span>
<span class="w">    </span><span class="nt">distributed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">distributed_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">39591</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="w">    </span><span class="nt">num_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">    </span><span class="nt">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3e-4</span>
<span class="w">    </span><span class="nt">scheduler_patience</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">scheduler_factor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.8</span>
<span class="w">    </span><span class="nt">log_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">checkpoint_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">scale_targets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">fixed_composition_weights</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">per_structure_targets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">log_mae</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">log_separate_blocks</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">best_model_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rmse_prod</span>
<span class="w">    </span><span class="nt">loss</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mse</span>
<span class="w">      </span><span class="nt">weights</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">      </span><span class="nt">reduction</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mean</span>
</pre></div>
</div>
</section>
<section id="tuning-hyperparameters">
<h2>Tuning Hyperparameters<a class="headerlink" href="#tuning-hyperparameters" title="Link to this heading">¶</a></h2>
<p>The default hyperparameters above will work well in most cases, but they
may not be optimal for your specific dataset. In general, the most important
hyperparameters to tune are (in decreasing order of importance):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cutoff</span></code>: This should be set to a value after which most of the interactions between
atoms is expected to be negligible. A lower cutoff will lead to faster models.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">learning_rate</span></code>: The learning rate for the neural network. This hyperparameter
controls how much the weights of the network are updated at each step of the
optimization. A larger learning rate will lead to faster training, but might cause
instability and/or divergence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">batch_size</span></code>: The number of samples to use in each batch of training. This
hyperparameter controls the tradeoff between training speed and memory usage. In
general, larger batch sizes will lead to faster training, but might require more
memory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d_pet</span></code>: This hyperparameters controls width of the neural network. In general,
increasing it might lead to better accuracy, especially on larger datasets, at the
cost of increased training and evaluation time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_gnn_layers</span></code>: The number of graph neural network layers. In general, decreasing
this hyperparameter to 1 will lead to much faster models, at the expense of accuracy.
Increasing it may or may not lead to better accuracy, depending on the dataset, at the
cost of increased training and evaluation time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_attention_layers</span></code>: The number of attention layers in each layer of the graph
neural network. Depending on the dataset, increasing this hyperparameter might lead to
better accuracy, at the cost of increased training and evaluation time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loss</span></code>: This section describes the loss function to be used, and it has three
subsections. 1. <code class="docutils literal notranslate"><span class="pre">weights</span></code>. This controls the weighting of different contributions
to the loss (e.g., energy, forces, virial, etc.). The default values of 1.0 for all
targets work well for most datasets, but they might need to be adjusted. For example,
to set a weight of 1.0 for the energy and 0.1 for the forces, you can set the
following in the <code class="docutils literal notranslate"><span class="pre">options.yaml</span></code> file under <code class="docutils literal notranslate"><span class="pre">loss</span></code>:
<code class="docutils literal notranslate"><span class="pre">weights:</span> <span class="pre">{&quot;energy&quot;:</span> <span class="pre">1.0,</span> <span class="pre">&quot;forces&quot;:</span> <span class="pre">0.1}</span></code>. 2. <code class="docutils literal notranslate"><span class="pre">type</span></code>. This controls the type of
loss to be used. The default value is <code class="docutils literal notranslate"><span class="pre">mse</span></code>, and other options are <code class="docutils literal notranslate"><span class="pre">mae</span></code> and
<code class="docutils literal notranslate"><span class="pre">huber</span></code>. <code class="docutils literal notranslate"><span class="pre">huber</span></code> is a subsection of its own, and it requires the user to specify
the <code class="docutils literal notranslate"><span class="pre">deltas</span></code> parameters in a similar way to how the <code class="docutils literal notranslate"><span class="pre">weights</span></code> are specified (e.g.,
<code class="docutils literal notranslate"><span class="pre">deltas:</span> <span class="pre">{&quot;energy&quot;:</span> <span class="pre">0.1,</span> <span class="pre">&quot;forces&quot;:</span> <span class="pre">0.01}</span></code>). 3. <code class="docutils literal notranslate"><span class="pre">reduction</span></code>. This controls how the
loss is reduced over batches. The default value is <code class="docutils literal notranslate"><span class="pre">mean</span></code>, and the other allowed
option is <code class="docutils literal notranslate"><span class="pre">sum</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">long_range</span></code>: In some systems and datasets, enabling long-range Coulomb interactions
might be beneficial for the accuracy of the model and/or its physical correctness.
See below for a breakdown of the long-range section of the model hyperparameters.</p></li>
</ul>
</section>
<section id="all-hyperparameters">
<h2>All Hyperparameters<a class="headerlink" href="#all-hyperparameters" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">param name<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">experimental.nanopet</span></code></p>
</dd>
</dl>
<section id="model">
<h3>model<a class="headerlink" href="#model" title="Link to this heading">¶</a></h3>
<p>The model-related hyperparameters are</p>
<dl class="field-list simple">
<dt class="field-odd">param cutoff<span class="colon">:</span></dt>
<dd class="field-odd"><p>Spherical cutoff to use for atomic environments</p>
</dd>
<dt class="field-even">param cutoff_width<span class="colon">:</span></dt>
<dd class="field-even"><p>Width of the shifted cosine cutoff function</p>
</dd>
<dt class="field-odd">param d_pet<span class="colon">:</span></dt>
<dd class="field-odd"><p>Width of the neural network</p>
</dd>
<dt class="field-even">param num_heads<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of attention heads</p>
</dd>
<dt class="field-odd">param num_attention_layers<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of attention layers in each GNN layer</p>
</dd>
<dt class="field-even">param num_gnn_layers<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of GNN layers</p>
</dd>
<dt class="field-odd">param heads<span class="colon">:</span></dt>
<dd class="field-odd"><p>The type of head (“linear” or “mlp”) to use for each target (e.g.
<code class="docutils literal notranslate"><span class="pre">heads:</span> <span class="pre">{&quot;energy&quot;:</span> <span class="pre">&quot;linear&quot;,</span> <span class="pre">&quot;mtt::dipole&quot;:</span> <span class="pre">&quot;mlp&quot;}</span></code>). All omitted targets will use a
MLP (multi-layer perceptron) head. MLP heads consist of two hidden layers with
dimensionality <code class="docutils literal notranslate"><span class="pre">d_pet</span></code>.</p>
</dd>
<dt class="field-even">param zbl<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to use the ZBL short-range repulsion as the baseline for the model</p>
</dd>
<dt class="field-odd">param long_range<span class="colon">:</span></dt>
<dd class="field-odd"><p>Parameters related to long-range interactions. <code class="docutils literal notranslate"><span class="pre">enable</span></code>: whether
to use long-range interactions; <code class="docutils literal notranslate"><span class="pre">use_ewald</span></code>: whether to use an Ewald calculator
(faster for smaller systems); <code class="docutils literal notranslate"><span class="pre">smearing</span></code>: the width of the Gaussian function used
to approximate the charge distribution in Fourier space; <code class="docutils literal notranslate"><span class="pre">kspace_resolution</span></code>: the
spatial resolution of the Fourier-space used for calculating long-range interactions;
<code class="docutils literal notranslate"><span class="pre">interpolation_nodes</span></code>: the number of grid points used in spline
interpolation for the P3M method.</p>
</dd>
</dl>
</section>
<section id="training">
<h3>training<a class="headerlink" href="#training" title="Link to this heading">¶</a></h3>
<p>The hyperparameters for training are</p>
<dl class="field-list simple">
<dt class="field-odd">param distributed<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to use distributed training</p>
</dd>
<dt class="field-even">param distributed_port<span class="colon">:</span></dt>
<dd class="field-even"><p>Port to use for distributed training</p>
</dd>
<dt class="field-odd">param batch_size<span class="colon">:</span></dt>
<dd class="field-odd"><p>Batch size for training</p>
</dd>
<dt class="field-even">param num_epochs<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of epochs to train for</p>
</dd>
<dt class="field-odd">param learning_rate<span class="colon">:</span></dt>
<dd class="field-odd"><p>Learning rate for the optimizer</p>
</dd>
<dt class="field-even">param scheduler_patience<span class="colon">:</span></dt>
<dd class="field-even"><p>Patience for the learning rate scheduler</p>
</dd>
<dt class="field-odd">param scheduler_factor<span class="colon">:</span></dt>
<dd class="field-odd"><p>Factor to reduce the learning rate by</p>
</dd>
<dt class="field-even">param log_interval<span class="colon">:</span></dt>
<dd class="field-even"><p>Interval at which to log training metrics</p>
</dd>
<dt class="field-odd">param checkpoint_interval<span class="colon">:</span></dt>
<dd class="field-odd"><p>Interval at which to save model checkpoints</p>
</dd>
<dt class="field-even">param scale_targets<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to scale the targets to have unit standard deviation
across the training set during training.</p>
</dd>
<dt class="field-odd">param fixed_composition_weights<span class="colon">:</span></dt>
<dd class="field-odd"><p>Weights for fixed atomic contributions to scalar
targets</p>
</dd>
<dt class="field-even">param per_structure_targets<span class="colon">:</span></dt>
<dd class="field-even"><p>Targets to calculate per-structure losses for</p>
</dd>
<dt class="field-odd">param log_mae<span class="colon">:</span></dt>
<dd class="field-odd"><p>Also logs MAEs in addition to RMSEs.</p>
</dd>
<dt class="field-even">param log_separate_blocks<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to log the errors each block of the targets
separately.</p>
</dd>
<dt class="field-odd">param loss<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loss function to use, with the subfields described in the previous
section</p>
</dd>
<dt class="field-even">param best_model_metric<span class="colon">:</span></dt>
<dd class="field-even"><p>specifies the validation set metric to use to select the best
model, i.e. the model that will be saved as <code class="docutils literal notranslate"><span class="pre">model.ckpt</span></code> and <code class="docutils literal notranslate"><span class="pre">model.pt</span></code> both in
the current directory and in the checkpoint directory. The default is <code class="docutils literal notranslate"><span class="pre">rmse_prod</span></code>,
i.e., the product of the RMSEs for each target. Other options are <code class="docutils literal notranslate"><span class="pre">mae_prod</span></code> and
<code class="docutils literal notranslate"><span class="pre">loss</span></code>.</p>
</dd>
</dl>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<div class="docutils container" id="id2">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-pozdnyakov-smooth-2023" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Sergey N. Pozdnyakov and Michele Ceriotti. Smooth, exact rotational symmetrization for deep learning on point clouds. <em>arXiv.org</em>, May 2023.</p>
</aside>
</aside>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="nativepet.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">NativePET (experimental)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="gap.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">GAP</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, metatrain developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-github fa-2x" href="https://github.com/metatensor/metatrain" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">NanoPET (experimental)</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#default-hyperparameters">Default Hyperparameters</a></li>
<li><a class="reference internal" href="#tuning-hyperparameters">Tuning Hyperparameters</a></li>
<li><a class="reference internal" href="#all-hyperparameters">All Hyperparameters</a><ul>
<li><a class="reference internal" href="#model">model</a></li>
<li><a class="reference internal" href="#training">training</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=562c1f90"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/toggleprompt.js?v=5801b3bb"></script>
    </body>
</html>