<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="SOAP-BPNN" href="soap_bpnn.html"><link rel="prev" title="NanoPET (deprecated)" href="nanopet.html">
        <link rel="canonical" href="https://docs.metatensor.org/metatrain/latest/architectures/generated/pet.html">
        <link rel="prefetch" href="../../_static/images/metatrain-horizontal.png" as="image">
        <link rel="prefetch" href="../../_static/images/metatrain-horizontal-dark.png" as="image">

    <link rel="shortcut icon" href="../../_static/metatrain-64.png"><!-- Generated with Sphinx 8.2.3 and Furo 2025.12.19 -->
        <title>PET - Metatrain</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles.css?v=e1ddca15" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Metatrain</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/images/metatrain-horizontal.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/images/metatrain-horizontal-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/index.html">Getting started</a><input aria-label="Toggle navigation of Getting started" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/quickstart.html">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/train_yaml_config.html">Training YAML Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/override.html">Override Architecture’s Default Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/checkpoints.html">Restarting and Checkpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/units.html">Units</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Available Architectures</a><input aria-label="Toggle navigation of Available Architectures" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="classifier.html">Classifier (Experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flashmd.html">FlashMD (Experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gap.html">GAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="llpr.html">LLPR</a></li>
<li class="toctree-l2"><a class="reference internal" href="mace.html">MACE (Experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="nanopet.html">NanoPET (deprecated)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">PET</a></li>
<li class="toctree-l2"><a class="reference internal" href="soap_bpnn.html">SOAP-BPNN</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../generated_examples/index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../generated_examples/0-beginner/index.html">Beginner Tutorials</a><input aria-label="Toggle navigation of Beginner Tutorials" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/00-basic-usage.html">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/01-data_preparation.html">How to prepare data for training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/02-fine-tuning.html">Fine-tuning a pre-trained model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/03-train_from_scratch.html">Training a model from scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/04-parity_plot.html">Model validation with parity plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/05-run_ase.html">Running molecular dynamics with ASE</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../generated_examples/1-advanced/index.html">Advanced Tutorials</a><input aria-label="Toggle navigation of Advanced Tutorials" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/00-transfer-learning.html">Transfer Learning (experimental)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/01-llpr.html">Computing LLPR uncertainties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/02-zbl.html">Training a model with ZBL corrections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/03-fitting-generic-targets.html">Fitting generic targets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/04-flashmd.html">Training or fine-tuning a FlashMD model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/05-multi-gpu.html">Multi-GPU training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/06-mixed-stress-training.html">Training with Mixed Stress Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/07-dos-training.html">Training a DOS model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/08-llpr-ensemble-training.html">Generating and training an LLPR-derived shallow ensemble model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/09-classifier.html">Training a Classifier Model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../concepts/index.html">Concepts and Design</a><input aria-label="Toggle navigation of Concepts and Design" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/output-naming.html">Output naming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/fine-tuning.html">Fine-tune a pre-trained model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/loss-functions.html">Loss functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/auxiliary-outputs.html">Auxiliary outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/batch-bounds.html">Training with Batch Bounds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Citing Metatrain</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dev-docs/index.html">Developer documentation</a><input aria-label="Toggle navigation of Developer documentation" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dev-docs/getting-started.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev-docs/architecture-life-cycle.html">Life Cycle of an Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev-docs/new-architecture.html">Adding a new architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev-docs/dataset-information.html">Dataset Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev-docs/new-loss.html">Adding a new loss function</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dev-docs/cli/index.html">CLI API</a><input aria-label="Toggle navigation of CLI API" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/cli/train.html">Train</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/cli/eval.html">Eval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/cli/export.html">Export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/cli/formatter.html">Formatter</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dev-docs/utils/index.html">Utility API</a><input aria-label="Toggle navigation of Utility API" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../dev-docs/utils/additive/index.html">Additive models</a><input aria-label="Toggle navigation of Additive models" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/additive/remove_additive.html">Removing additive contributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/additive/composition.html">Composition model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/additive/zbl.html">ZBL short-range potential</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../dev-docs/utils/scaler/index.html">Scaler models</a><input aria-label="Toggle navigation of Scaler models" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/scaler/scaler.html">Scaler model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/scaler/remove_scale.html">Removing the scale from targets</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../dev-docs/utils/data/index.html">Data</a><input aria-label="Toggle navigation of Data" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/data/combine_dataloaders.html">Combining dataloaders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/data/dataset.html">Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/data/get_dataset.html">Reading a dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/data/readers.html">Readers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/data/writers.html">Target data Writers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev-docs/utils/data/systems_to_ase.html">Converting Systems to ASE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/abc.html">Abstract base classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/architectures.html">Architectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/augmentation.html">Augmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/devices.html">Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/dtype.html">Dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/errors.html">Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/evaluate_model.html">Evaluating a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/external_naming.html">External Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/hypers.html">Hyperparameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/io.html">IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/logging.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/long_range.html">Long-range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/loss.html">Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/metrics.html">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/neighbor_lists.html">Neighbor lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/omegaconf.html">Custom omegaconf functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/output_gradient.html">Output gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/per_atom.html">Averaging predictions per atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/pydantic.html">Pydantic utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/sum_over_atoms.html">Summing over atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/testing.html">Testing Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/transfer.html">Data type and device transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev-docs/utils/units.html">Unit handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../dev-docs/base-hypers.html">Base hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev-docs/changelog.html">Changelog</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/architectures/generated/pet.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="pet">
<span id="arch-pet"></span><h1>PET<a class="headerlink" href="#pet" title="Link to this heading">¶</a></h1>
<p>PET is a cleaner, more user-friendly reimplementation of the original
PET model <a class="footnote-reference brackets" href="#footcite-pozdnyakov-smooth-2023" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. It is designed for better
modularity and maintainability, while preseving compatibility with the original
PET implementation in <code class="docutils literal notranslate"><span class="pre">metatrain</span></code>. It also adds new features like long-range
features, better fine-tuning implementation, a possibility to train on
arbitrarty targets, and a faster inference due to the <code class="docutils literal notranslate"><span class="pre">fast</span> <span class="pre">attention</span></code>.</p>
<section id="installation">
<span id="arch-pet-installation"></span><h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>To install this architecture along with the <code class="docutils literal notranslate"><span class="pre">metatrain</span></code> package, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>metatrain<span class="o">[</span>pet<span class="o">]</span>
</pre></div>
</div>
<p>where the square brackets indicate that you want to install the optional
dependencies required for <code class="docutils literal notranslate"><span class="pre">pet</span></code>.</p>
</section>
<section id="additional-outputs">
<h2>Additional outputs<a class="headerlink" href="#additional-outputs" title="Link to this heading">¶</a></h2>
<p>In addition to the targets defined in the dataset, the PET architecture can also output
the following additional quantity:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">features</span></code>: the internal PET features, before the different heads for each target.</p></li>
<li><p><a class="reference internal" href="../../concepts/auxiliary-outputs.html#mtt-aux-target-last-layer-features"><span class="std std-ref">mtt::aux::{target}_last_layer_features</span></a>: The features for a given target, taken
before the last linear layer of the corresponding head.</p></li>
</ul>
</section>
<section id="default-hyperparameters">
<span id="arch-pet-default-hypers"></span><h2>Default Hyperparameters<a class="headerlink" href="#default-hyperparameters" title="Link to this heading">¶</a></h2>
<p>The description of all the hyperparameters used in <code class="docutils literal notranslate"><span class="pre">pet</span></code> is provided
further down this page. However, here we provide you with a yaml file containing all
the default hyperparameters, which might be convenient as a starting point to
create your own hyperparameter files:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">architecture</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pet</span>
<span class="w">  </span><span class="nt">model</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cutoff</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.5</span>
<span class="w">    </span><span class="nt">num_neighbors_adaptive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">    </span><span class="nt">cutoff_function</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bump</span>
<span class="w">    </span><span class="nt">cutoff_width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
<span class="w">    </span><span class="nt">d_pet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">128</span>
<span class="w">    </span><span class="nt">d_head</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">128</span>
<span class="w">    </span><span class="nt">d_node</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256</span>
<span class="w">    </span><span class="nt">d_feedforward</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256</span>
<span class="w">    </span><span class="nt">num_heads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">num_attention_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">num_gnn_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">normalization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RMSNorm</span>
<span class="w">    </span><span class="nt">activation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SwiGLU</span>
<span class="w">    </span><span class="nt">attention_temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">    </span><span class="nt">transformer_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PreLN</span>
<span class="w">    </span><span class="nt">featurizer_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feedforward</span>
<span class="w">    </span><span class="nt">zbl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">long_range</span><span class="p">:</span>
<span class="w">      </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">use_ewald</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">smearing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.4</span>
<span class="w">      </span><span class="nt">kspace_resolution</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.33</span>
<span class="w">      </span><span class="nt">interpolation_nodes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">  </span><span class="nt">training</span><span class="p">:</span>
<span class="w">    </span><span class="nt">distributed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">distributed_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">39591</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="w">    </span><span class="nt">num_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">    </span><span class="nt">warmup_fraction</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.01</span>
<span class="w">    </span><span class="nt">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="w">    </span><span class="nt">weight_decay</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">    </span><span class="nt">log_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">checkpoint_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">atomic_baseline</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">scale_targets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">fixed_scaling_weights</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">per_structure_targets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">num_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">    </span><span class="nt">log_mae</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">log_separate_blocks</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">best_model_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mae_prod</span>
<span class="w">    </span><span class="nt">grad_clip_norm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">    </span><span class="nt">loss</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mse</span>
<span class="w">    </span><span class="nt">batch_atom_bounds</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">    </span><span class="nt">finetune</span><span class="p">:</span>
<span class="w">      </span><span class="nt">read_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">full</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">      </span><span class="nt">inherit_heads</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</section>
<section id="tuning-hyperparameters">
<h2>Tuning hyperparameters<a class="headerlink" href="#tuning-hyperparameters" title="Link to this heading">¶</a></h2>
<p>The default hyperparameters above will work well in most cases, but they may not be
optimal for your specific dataset. There is good number of parameters to tune, both for
the <a class="reference internal" href="#arch-pet-model-hypers"><span class="std std-ref">model</span></a> and the <a class="reference internal" href="#arch-pet-trainer-hypers"><span class="std std-ref">trainer</span></a>. Since seeing them for the first time might be
overwhelming, here we provide a <strong>list of the parameters that are in general the most
important</strong> (in decreasing order of importance):</p>
<div class="mtt-hypers-remove-classname docutils container">
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">cutoff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4.5</span></em></dt>
<dd><p>Cutoff radius for neighbor search.</p>
<p>This should be set to a value after which most of the interactions
between atoms is expected to be negligible. A lower cutoff will lead
to faster models.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">num_neighbors_adaptive</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd><p>Target number of neighbors for the adaptive cutoff scheme.</p>
<p>This parameter activates the adaptive cutoff functionality.
Each atomic environments has a different cutoff, that is chosen
such that the number of neighbors is approximately equal to this
value. This can be useful to have a more uniform number of neighbors
per atom, especially in sparse systems. Setting it to None disables
this feature and uses all neighbors within the fixed cutoff radius.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">learning_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0001</span></em></dt>
<dd><p>Learning rate.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em></dt>
<dd><p>The number of samples to use in each batch of training. This
hyperparameter controls the tradeoff between training speed and memory usage. In
general, larger batch sizes will lead to faster training, but might require more
memory.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">d_pet</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">128</span></em></dt>
<dd><p>Dimension of the edge features.</p>
<p>This hyperparameters controls width of the neural network. In general,
increasing it might lead to better accuracy, especially on larger datasets, at the
cost of increased training and evaluation time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">d_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em></dt>
<dd><p>Dimension of the node features.</p>
<p>Increasing this hyperparameter might lead to better accuracy,
with a relatively small increase in inference time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">num_gnn_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em></dt>
<dd><p>The number of graph neural network layers.</p>
<p>In general, decreasing this hyperparameter to 1 will lead to much faster models,
at the expense of accuracy. Increasing it may or may not lead to better accuracy,
depending on the dataset, at the cost of increased training and evaluation time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">num_attention_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em></dt>
<dd><p>The number of attention layers in each layer of the graph
neural network. Depending on the dataset, increasing this hyperparameter might
lead to better accuracy, at the cost of increased training and evaluation time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../../dev-docs/utils/loss.html#metatrain.utils.loss.LossSpecification" title="metatrain.utils.loss.LossSpecification"><span class="pre">LossSpecification</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mse'</span></em></dt>
<dd><p>This section describes the loss function to be used. See the
<a class="reference internal" href="../../concepts/loss-functions.html#loss-functions"><span class="std std-ref">Loss functions</span></a> for more details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">long_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../dev-docs/utils/long_range.html#metatrain.utils.long_range.LongRangeHypers" title="metatrain.utils.long_range.LongRangeHypers"><span class="pre">LongRangeHypers</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'enable':</span> <span class="pre">False,</span> <span class="pre">'interpolation_nodes':</span> <span class="pre">5,</span> <span class="pre">'kspace_resolution':</span> <span class="pre">1.33,</span> <span class="pre">'smearing':</span> <span class="pre">1.4,</span> <span class="pre">'use_ewald':</span> <span class="pre">False}</span></em></dt>
<dd><p>Long-range Coulomb interactions parameters.</p>
</dd></dl>

</div>
</section>
<section id="model-hyperparameters">
<span id="arch-pet-model-hypers"></span><h2>Model hyperparameters<a class="headerlink" href="#model-hyperparameters" title="Link to this heading">¶</a></h2>
<p>The parameters that go under the <code class="docutils literal notranslate"><span class="pre">architecture.model</span></code> section of the config file
are the following:</p>
<div class="mtt-hypers-remove-classname docutils container">
<blockquote>
<div><dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.cutoff">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">cutoff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4.5</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.cutoff" title="Link to this definition">¶</a></dt>
<dd><p>Cutoff radius for neighbor search.</p>
<p>This should be set to a value after which most of the interactions
between atoms is expected to be negligible. A lower cutoff will lead
to faster models.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.num_neighbors_adaptive">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">num_neighbors_adaptive</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.num_neighbors_adaptive" title="Link to this definition">¶</a></dt>
<dd><p>Target number of neighbors for the adaptive cutoff scheme.</p>
<p>This parameter activates the adaptive cutoff functionality.
Each atomic environments has a different cutoff, that is chosen
such that the number of neighbors is approximately equal to this
value. This can be useful to have a more uniform number of neighbors
per atom, especially in sparse systems. Setting it to None disables
this feature and uses all neighbors within the fixed cutoff radius.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.cutoff_function">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">cutoff_function</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Cosine'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Bump'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Bump'</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.cutoff_function" title="Link to this definition">¶</a></dt>
<dd><p>Type of the smoothing function at the cutoff</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.cutoff_width">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">cutoff_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.cutoff_width" title="Link to this definition">¶</a></dt>
<dd><p>Width of the smoothing function at the cutoff</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.d_pet">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">d_pet</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">128</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.d_pet" title="Link to this definition">¶</a></dt>
<dd><p>Dimension of the edge features.</p>
<p>This hyperparameters controls width of the neural network. In general,
increasing it might lead to better accuracy, especially on larger datasets, at the
cost of increased training and evaluation time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.d_head">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">d_head</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">128</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.d_head" title="Link to this definition">¶</a></dt>
<dd><p>Dimension of the attention heads.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.d_node">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">d_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.d_node" title="Link to this definition">¶</a></dt>
<dd><p>Dimension of the node features.</p>
<p>Increasing this hyperparameter might lead to better accuracy,
with a relatively small increase in inference time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.d_feedforward">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">d_feedforward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.d_feedforward" title="Link to this definition">¶</a></dt>
<dd><p>Dimension of the feedforward network in the attention layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.num_heads">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">num_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.num_heads" title="Link to this definition">¶</a></dt>
<dd><p>Attention heads per attention layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.num_attention_layers">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">num_attention_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.num_attention_layers" title="Link to this definition">¶</a></dt>
<dd><p>The number of attention layers in each layer of the graph
neural network. Depending on the dataset, increasing this hyperparameter might
lead to better accuracy, at the cost of increased training and evaluation time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.num_gnn_layers">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">num_gnn_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.num_gnn_layers" title="Link to this definition">¶</a></dt>
<dd><p>The number of graph neural network layers.</p>
<p>In general, decreasing this hyperparameter to 1 will lead to much faster models,
at the expense of accuracy. Increasing it may or may not lead to better accuracy,
depending on the dataset, at the cost of increased training and evaluation time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.normalization">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">normalization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'RMSNorm'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'LayerNorm'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'RMSNorm'</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.normalization" title="Link to this definition">¶</a></dt>
<dd><p>Layer normalization type.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.activation">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">activation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'SiLU'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'SwiGLU'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'SwiGLU'</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.activation" title="Link to this definition">¶</a></dt>
<dd><p>Activation function.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.attention_temperature">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">attention_temperature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.attention_temperature" title="Link to this definition">¶</a></dt>
<dd><p>The temperature scaling factor for attention scores.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.transformer_type">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">transformer_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'PreLN'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'PostLN'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'PreLN'</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.transformer_type" title="Link to this definition">¶</a></dt>
<dd><p>The order in which the layer normalization and attention
are applied in a transformer block. Available options are <code class="docutils literal notranslate"><span class="pre">PreLN</span></code>
(normalization before attention) and <code class="docutils literal notranslate"><span class="pre">PostLN</span></code> (normalization after attention).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.featurizer_type">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">featurizer_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'residual'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'feedforward'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'feedforward'</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.featurizer_type" title="Link to this definition">¶</a></dt>
<dd><p>Implementation of the featurizer of the model to use. Available
options are <code class="docutils literal notranslate"><span class="pre">residual</span></code> (the original featurizer from the PET paper, that uses
residual connections at each GNN layer for readout) and <code class="docutils literal notranslate"><span class="pre">feedforward</span></code> (a modern
version that uses the last representation after all GNN iterations for readout).
Additionally, the feedforward version uses bidirectional features flow during the
message passing iterations, that favors features flowing from atom <code class="docutils literal notranslate"><span class="pre">i</span></code> to atom
<code class="docutils literal notranslate"><span class="pre">j</span></code> to be not equal to the features flowing from atom <code class="docutils literal notranslate"><span class="pre">j</span></code> to atom <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.zbl">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">zbl</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.zbl" title="Link to this definition">¶</a></dt>
<dd><p>Use ZBL potential for short-range repulsion</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.ModelHypers.long_range">
<span class="sig-prename descclassname"><span class="pre">ModelHypers.</span></span><span class="sig-name descname"><span class="pre">long_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../dev-docs/utils/long_range.html#metatrain.utils.long_range.LongRangeHypers" title="metatrain.utils.long_range.LongRangeHypers"><span class="pre">LongRangeHypers</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'enable':</span> <span class="pre">False,</span> <span class="pre">'interpolation_nodes':</span> <span class="pre">5,</span> <span class="pre">'kspace_resolution':</span> <span class="pre">1.33,</span> <span class="pre">'smearing':</span> <span class="pre">1.4,</span> <span class="pre">'use_ewald':</span> <span class="pre">False}</span></em><a class="headerlink" href="#metatrain.pet.documentation.ModelHypers.long_range" title="Link to this definition">¶</a></dt>
<dd><p>Long-range Coulomb interactions parameters.</p>
</dd></dl>

</div></blockquote>
</div>
</section>
<section id="trainer-hyperparameters">
<span id="arch-pet-trainer-hypers"></span><h2>Trainer hyperparameters<a class="headerlink" href="#trainer-hyperparameters" title="Link to this heading">¶</a></h2>
<p>The parameters that go under the <code class="docutils literal notranslate"><span class="pre">architecture.trainer</span></code> section of the config file
are the following:</p>
<div class="mtt-hypers-remove-classname docutils container">
<blockquote>
<div><dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.distributed">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">distributed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.distributed" title="Link to this definition">¶</a></dt>
<dd><p>Whether to use distributed training</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.distributed_port">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">distributed_port</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">39591</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.distributed_port" title="Link to this definition">¶</a></dt>
<dd><p>Port for distributed communication among processes</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.batch_size">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.batch_size" title="Link to this definition">¶</a></dt>
<dd><p>The number of samples to use in each batch of training. This
hyperparameter controls the tradeoff between training speed and memory usage. In
general, larger batch sizes will lead to faster training, but might require more
memory.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.num_epochs">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">num_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.num_epochs" title="Link to this definition">¶</a></dt>
<dd><p>Number of epochs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.warmup_fraction">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">warmup_fraction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.warmup_fraction" title="Link to this definition">¶</a></dt>
<dd><p>Fraction of training steps used for learning rate warmup.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.learning_rate">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">learning_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0001</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>Learning rate.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.weight_decay">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">weight_decay</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.weight_decay" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.log_interval">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">log_interval</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.log_interval" title="Link to this definition">¶</a></dt>
<dd><p>Interval to log metrics.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.checkpoint_interval">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">checkpoint_interval</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.checkpoint_interval" title="Link to this definition">¶</a></dt>
<dd><p>Interval to save checkpoints.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.atomic_baseline">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">atomic_baseline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.atomic_baseline" title="Link to this definition">¶</a></dt>
<dd><p>The baselines for each target.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">metatrain</span></code> will fit a linear model (<a class="reference internal" href="../../dev-docs/utils/additive/composition.html#metatrain.utils.additive.composition.CompositionModel" title="metatrain.utils.additive.composition.CompositionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompositionModel</span></code></a>) to compute the
least squares baseline for each atomic species for each target.</p>
<p>However, this hyperparameter allows you to provide your own baselines.
The value of the hyperparameter should be a dictionary where the keys are the
target names, and the values are either (1) a single baseline to be used for
all atomic types, or (2) a dictionary mapping atomic types to their baselines.
For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">atomic_baseline:</span> <span class="pre">{&quot;energy&quot;:</span> <span class="pre">{1:</span> <span class="pre">-0.5,</span> <span class="pre">6:</span> <span class="pre">-10.0}}</span></code> will fix the energy
baseline for hydrogen (Z=1) to -0.5 and for carbon (Z=6) to -10.0, while
fitting the baselines for the energy of all other atomic types, as well
as fitting the baselines for all other targets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">atomic_baseline:</span> <span class="pre">{&quot;energy&quot;:</span> <span class="pre">-5.0}</span></code> will fix the energy baseline for
all atomic types to -5.0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">atomic_baseline:</span> <span class="pre">{&quot;mtt:dos&quot;:</span> <span class="pre">0.0}</span></code> sets the baseline for the “mtt:dos”
target to 0.0, effectively disabling the atomic baseline for that target.</p></li>
</ul>
<p>This atomic baseline is substracted from the targets during training, which
avoids the main model needing to learn atomic contributions, and likely makes
training easier. When the model is used in evaluation mode, the atomic baseline
is added on top of the model predictions automatically.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This atomic baseline is a per-atom contribution. Therefore, if the property
you are predicting is a sum over all atoms (e.g., total energy), the
contribution of the atomic baseline to the total property will be the
atomic baseline multiplied by the number of atoms of that type in the
structure.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.scale_targets">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">scale_targets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.scale_targets" title="Link to this definition">¶</a></dt>
<dd><p>Normalize targets to unit std during training.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.fixed_scaling_weights">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">fixed_scaling_weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.fixed_scaling_weights" title="Link to this definition">¶</a></dt>
<dd><p>Weights for target scaling.</p>
<p>This is passed to the <code class="docutils literal notranslate"><span class="pre">fixed_weights</span></code> argument of
<a class="reference internal" href="../../dev-docs/utils/scaler/scaler.html#metatrain.utils.scaler.scaler.Scaler.train_model" title="metatrain.utils.scaler.scaler.Scaler.train_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Scaler.train_model</span></code></a>,
see its documentation to understand exactly what to pass here.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.per_structure_targets">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">per_structure_targets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.per_structure_targets" title="Link to this definition">¶</a></dt>
<dd><p>Targets to calculate per-structure losses and errors on.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.num_workers">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">num_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.num_workers" title="Link to this definition">¶</a></dt>
<dd><p>Number of workers for data loading. If not provided, it is set
automatically.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.log_mae">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">log_mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.log_mae" title="Link to this definition">¶</a></dt>
<dd><p>Log MAE alongside RMSE</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.log_separate_blocks">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">log_separate_blocks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.log_separate_blocks" title="Link to this definition">¶</a></dt>
<dd><p>Log per-block error.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.best_model_metric">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">best_model_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'rmse_prod'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mae_prod'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'loss'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mae_prod'</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.best_model_metric" title="Link to this definition">¶</a></dt>
<dd><p>Metric used to select best checkpoint (e.g., <code class="docutils literal notranslate"><span class="pre">rmse_prod</span></code>)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.grad_clip_norm">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">grad_clip_norm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.grad_clip_norm" title="Link to this definition">¶</a></dt>
<dd><p>Maximum gradient norm value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.loss">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../../dev-docs/utils/loss.html#metatrain.utils.loss.LossSpecification" title="metatrain.utils.loss.LossSpecification"><span class="pre">LossSpecification</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mse'</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.loss" title="Link to this definition">¶</a></dt>
<dd><p>This section describes the loss function to be used. See the
<a class="reference internal" href="../../concepts/loss-functions.html#loss-functions"><span class="std std-ref">Loss functions</span></a> for more details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.batch_atom_bounds">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">batch_atom_bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[None,</span> <span class="pre">None]</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.batch_atom_bounds" title="Link to this definition">¶</a></dt>
<dd><p>Bounds for the number of atoms per batch as [min, max]. Batches with atom
counts outside these bounds will be skipped during training. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> for
either value to disable that bound. This is useful for preventing out-of-memory
errors and ensuring consistent computational load. Default: <code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None]</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.pet.documentation.TrainerHypers.finetune">
<span class="sig-prename descclassname"><span class="pre">TrainerHypers.</span></span><span class="sig-name descname"><span class="pre">finetune</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">NoFinetuneHypers</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">FullFinetuneHypers</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">LoRaFinetuneHypers</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">HeadsFinetuneHypers</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'config':</span> <span class="pre">{},</span> <span class="pre">'inherit_heads':</span> <span class="pre">{},</span> <span class="pre">'method':</span> <span class="pre">'full',</span> <span class="pre">'read_from':</span> <span class="pre">None}</span></em><a class="headerlink" href="#metatrain.pet.documentation.TrainerHypers.finetune" title="Link to this definition">¶</a></dt>
<dd><p>Parameters for fine-tuning trained PET models.</p>
<p>See <a class="reference internal" href="../../concepts/fine-tuning.html#label-fine-tuning-concept"><span class="std std-ref">Fine-tune a pre-trained model</span></a> for more details.</p>
</dd></dl>

</div></blockquote>
</div>
</section>
<section id="references">
<span id="arch-pet-references"></span><h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<div class="docutils container" id="id2">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-pozdnyakov-smooth-2023" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Sergey N. Pozdnyakov and Michele Ceriotti. Smooth, exact rotational symmetrization for deep learning on point clouds. <em>arXiv.org</em>, May 2023.</p>
</aside>
</aside>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="soap_bpnn.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">SOAP-BPNN</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="nanopet.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">NanoPET (deprecated)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2026, metatrain developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-github fa-2x" href="https://github.com/metatensor/metatrain" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">PET</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#additional-outputs">Additional outputs</a></li>
<li><a class="reference internal" href="#default-hyperparameters">Default Hyperparameters</a></li>
<li><a class="reference internal" href="#tuning-hyperparameters">Tuning hyperparameters</a></li>
<li><a class="reference internal" href="#model-hyperparameters">Model hyperparameters</a><ul>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.cutoff"><code class="docutils literal notranslate"><span class="pre">ModelHypers.cutoff</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.num_neighbors_adaptive"><code class="docutils literal notranslate"><span class="pre">ModelHypers.num_neighbors_adaptive</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.cutoff_function"><code class="docutils literal notranslate"><span class="pre">ModelHypers.cutoff_function</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.cutoff_width"><code class="docutils literal notranslate"><span class="pre">ModelHypers.cutoff_width</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.d_pet"><code class="docutils literal notranslate"><span class="pre">ModelHypers.d_pet</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.d_head"><code class="docutils literal notranslate"><span class="pre">ModelHypers.d_head</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.d_node"><code class="docutils literal notranslate"><span class="pre">ModelHypers.d_node</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.d_feedforward"><code class="docutils literal notranslate"><span class="pre">ModelHypers.d_feedforward</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.num_heads"><code class="docutils literal notranslate"><span class="pre">ModelHypers.num_heads</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.num_attention_layers"><code class="docutils literal notranslate"><span class="pre">ModelHypers.num_attention_layers</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.num_gnn_layers"><code class="docutils literal notranslate"><span class="pre">ModelHypers.num_gnn_layers</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.normalization"><code class="docutils literal notranslate"><span class="pre">ModelHypers.normalization</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.activation"><code class="docutils literal notranslate"><span class="pre">ModelHypers.activation</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.attention_temperature"><code class="docutils literal notranslate"><span class="pre">ModelHypers.attention_temperature</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.transformer_type"><code class="docutils literal notranslate"><span class="pre">ModelHypers.transformer_type</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.featurizer_type"><code class="docutils literal notranslate"><span class="pre">ModelHypers.featurizer_type</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.zbl"><code class="docutils literal notranslate"><span class="pre">ModelHypers.zbl</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.ModelHypers.long_range"><code class="docutils literal notranslate"><span class="pre">ModelHypers.long_range</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#trainer-hyperparameters">Trainer hyperparameters</a><ul>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.distributed"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.distributed</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.distributed_port"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.distributed_port</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.batch_size"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.batch_size</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.num_epochs"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.num_epochs</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.warmup_fraction"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.warmup_fraction</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.learning_rate"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.learning_rate</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.weight_decay"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.weight_decay</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.log_interval"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.log_interval</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.checkpoint_interval"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.checkpoint_interval</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.atomic_baseline"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.atomic_baseline</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.scale_targets"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.scale_targets</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.fixed_scaling_weights"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.fixed_scaling_weights</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.per_structure_targets"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.per_structure_targets</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.num_workers"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.num_workers</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.log_mae"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.log_mae</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.log_separate_blocks"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.log_separate_blocks</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.best_model_metric"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.best_model_metric</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.grad_clip_norm"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.grad_clip_norm</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.loss"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.loss</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.batch_atom_bounds"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.batch_atom_bounds</span></code></a></li>
<li><a class="reference internal" href="#metatrain.pet.documentation.TrainerHypers.finetune"><code class="docutils literal notranslate"><span class="pre">TrainerHypers.finetune</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=1afdfbfd"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/toggleprompt.js?v=5801b3bb"></script>
    </body>
</html>