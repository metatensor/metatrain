<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="Data type and device transfers" href="transfer.html"><link rel="prev" title="Summing over atoms" href="sum_over_atoms.html">
        <link rel="canonical" href="https://docs.metatensor.org/metatrain/latest/dev-docs/utils/testing.html">
        <link rel="prefetch" href="../../_static/images/metatrain-horizontal.png" as="image">
        <link rel="prefetch" href="../../_static/images/metatrain-horizontal-dark.png" as="image">

    <link rel="shortcut icon" href="../../_static/metatrain-64.png"><!-- Generated with Sphinx 8.2.3 and Furo 2025.12.19 -->
        <title>Testing Utilities - Metatrain</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles.css?v=e1ddca15" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Metatrain</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/images/metatrain-horizontal.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/images/metatrain-horizontal-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/index.html">Getting started</a><input aria-label="Toggle navigation of Getting started" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/quickstart.html">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/train_yaml_config.html">Training YAML Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/override.html">Override Architecture’s Default Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/checkpoints.html">Restarting and Checkpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/units.html">Units</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../architectures/index.html">Available Architectures</a><input aria-label="Toggle navigation of Available Architectures" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../architectures/generated/classifier.html">Classifier (Experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architectures/generated/flashmd.html">FlashMD (Experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architectures/generated/gap.html">GAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architectures/generated/llpr.html">LLPR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architectures/generated/mace.html">MACE (Experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architectures/generated/nanopet.html">NanoPET (deprecated)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architectures/generated/pet.html">PET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architectures/generated/soap_bpnn.html">SOAP-BPNN</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../generated_examples/index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../generated_examples/0-beginner/index.html">Beginner Tutorials</a><input aria-label="Toggle navigation of Beginner Tutorials" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/00-basic-usage.html">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/01-data_preparation.html">How to prepare data for training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/02-fine-tuning.html">Fine-tuning a pre-trained model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/03-train_from_scratch.html">Training a model from scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/04-parity_plot.html">Model validation with parity plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/0-beginner/05-run_ase.html">Running molecular dynamics with ASE</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../generated_examples/1-advanced/index.html">Advanced Tutorials</a><input aria-label="Toggle navigation of Advanced Tutorials" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/00-transfer-learning.html">Transfer Learning (experimental)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/01-llpr.html">Computing LLPR uncertainties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/02-zbl.html">Training a model with ZBL corrections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/03-fitting-generic-targets.html">Fitting generic targets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/04-flashmd.html">Training or fine-tuning a FlashMD model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/05-multi-gpu.html">Multi-GPU training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/06-mixed-stress-training.html">Training with Mixed Stress Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/07-dos-training.html">Training a DOS model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/08-llpr-ensemble-training.html">Generating and training an LLPR-derived shallow ensemble model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated_examples/1-advanced/09-classifier.html">Training a Classifier Model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../concepts/index.html">Concepts and Design</a><input aria-label="Toggle navigation of Concepts and Design" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/output-naming.html">Output naming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/fine-tuning.html">Fine-tune a pre-trained model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/loss-functions.html">Loss functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/auxiliary-outputs.html">Auxiliary outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/batch-bounds.html">Training with Batch Bounds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Citing Metatrain</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Developer documentation</a><input aria-label="Toggle navigation of Developer documentation" checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture-life-cycle.html">Life Cycle of an Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../new-architecture.html">Adding a new architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataset-information.html">Dataset Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../new-loss.html">Adding a new loss function</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cli/index.html">CLI API</a><input aria-label="Toggle navigation of CLI API" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cli/train.html">Train</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cli/eval.html">Eval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cli/export.html">Export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cli/formatter.html">Formatter</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Utility API</a><input aria-label="Toggle navigation of Utility API" checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="additive/index.html">Additive models</a><input aria-label="Toggle navigation of Additive models" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="additive/remove_additive.html">Removing additive contributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="additive/composition.html">Composition model</a></li>
<li class="toctree-l4"><a class="reference internal" href="additive/zbl.html">ZBL short-range potential</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="scaler/index.html">Scaler models</a><input aria-label="Toggle navigation of Scaler models" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="scaler/scaler.html">Scaler model</a></li>
<li class="toctree-l4"><a class="reference internal" href="scaler/remove_scale.html">Removing the scale from targets</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="data/index.html">Data</a><input aria-label="Toggle navigation of Data" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="data/combine_dataloaders.html">Combining dataloaders</a></li>
<li class="toctree-l4"><a class="reference internal" href="data/dataset.html">Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="data/get_dataset.html">Reading a dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="data/readers.html">Readers</a></li>
<li class="toctree-l4"><a class="reference internal" href="data/writers.html">Target data Writers</a></li>
<li class="toctree-l4"><a class="reference internal" href="data/systems_to_ase.html">Converting Systems to ASE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="abc.html">Abstract base classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="architectures.html">Architectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="augmentation.html">Augmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="devices.html">Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="dtype.html">Dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="errors.html">Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="evaluate_model.html">Evaluating a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="external_naming.html">External Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="hypers.html">Hyperparameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="io.html">IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="long_range.html">Long-range</a></li>
<li class="toctree-l3"><a class="reference internal" href="loss.html">Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="neighbor_lists.html">Neighbor lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="omegaconf.html">Custom omegaconf functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="output_gradient.html">Output gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="per_atom.html">Averaging predictions per atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="pydantic.html">Pydantic utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="sum_over_atoms.html">Summing over atoms</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Testing Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="transfer.html">Data type and device transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="units.html">Unit handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../base-hypers.html">Base hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/dev-docs/utils/testing.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="testing-utilities">
<span id="id1"></span><h1>Testing Utilities<a class="headerlink" href="#testing-utilities" title="Link to this heading">¶</a></h1>
<section id="the-base-class-for-tests">
<h2>The base class for tests<a class="headerlink" href="#the-base-class-for-tests" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.testing.</span></span><span class="sig-name descname"><span class="pre">ArchitectureTests</span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This is the base class for all architecture tests.</p>
<p>It doesn’t implement any tests itself, but provides fixtures
and helper functions that are generally useful for testing
architectures.</p>
<p>Child classes can override everything, including fixtures, to
make the tests suit their needs. Note that some fixtures defined
here depend on other fixtures, but when overriding them, you can
change completely their signature.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.architecture">
<span class="sig-name descname"><span class="pre">architecture</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.architecture" title="Link to this definition">¶</a></dt>
<dd><p>Name of the architecture to be tested.</p>
<p>Based on this, the test suite will find the model and trainer classes
as well as the hyperparameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.dataset_path">
<span class="sig-name descname"><span class="pre">dataset_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.dataset_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.dataset_path" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides a path to a dataset file for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The path to the dataset file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.dataset_targets">
<span class="sig-name descname"><span class="pre">dataset_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.dataset_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.dataset_targets" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides the target hyperparameters for the dataset used
in testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The path to the dataset file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary with target hyperparameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.get_dataset">
<span class="sig-name descname"><span class="pre">get_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.metatensor.org/latest/learn/reference/data/index.html#metatensor.learn.Dataset" title="(in metatensor)"><span class="pre">Dataset</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TargetInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.get_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.get_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to load the dataset used in testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>]</em>) – The target hyperparameters for the dataset.</p></li>
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The path to the dataset file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the dataset, target info, and dataset info.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>[<a class="reference external" href="https://docs.metatensor.org/latest/learn/reference/data/index.html#metatensor.learn.Dataset" title="(in metatensor)"><em>Dataset</em></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>, <em>TargetInfo</em>], <a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.device">
<span class="sig-name descname"><span class="pre">device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FixtureRequest</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><span class="pre">device</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.device" title="Link to this definition">¶</a></dt>
<dd><p>Fixture to provide the torch device for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>FixtureRequest</em>) – The pytest request fixture.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The torch device to be used.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>device</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FixtureRequest</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><span class="pre">dtype</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.dtype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.dtype" title="Link to this definition">¶</a></dt>
<dd><p>Fixture to provide the model data type for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>FixtureRequest</em>) – The pytest request fixture.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The torch data type to be used.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><em>dtype</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.dataset_info">
<span class="sig-name descname"><span class="pre">dataset_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.dataset_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.dataset_info" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides a basic <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> with an
energy target for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> instance with an energy target.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.per_atom">
<span class="sig-name descname"><span class="pre">per_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FixtureRequest</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.per_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.per_atom" title="Link to this definition">¶</a></dt>
<dd><p>Fixture to test both per-atom and per-system targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>FixtureRequest</em>) – The pytest request fixture.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the target is per-atom or not.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.dataset_info_scalar">
<span class="sig-name descname"><span class="pre">dataset_info_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.dataset_info_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.dataset_info_scalar" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides a basic <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> with a scalar target
for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether the target is per-atom or not.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> instance with a scalar target.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.dataset_info_vector">
<span class="sig-name descname"><span class="pre">dataset_info_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.dataset_info_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.dataset_info_vector" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides a basic <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> with a vector target
for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether the target is per-atom or not.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> instance with a vector target.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.o3_lambda">
<span class="sig-name descname"><span class="pre">o3_lambda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FixtureRequest</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.o3_lambda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.o3_lambda" title="Link to this definition">¶</a></dt>
<dd><p>Fixture to provide different O(3) lambda values for
testing spherical tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>FixtureRequest</em>) – The pytest request fixture.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The O(3) lambda value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.o3_sigma">
<span class="sig-name descname"><span class="pre">o3_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FixtureRequest</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.o3_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.o3_sigma" title="Link to this definition">¶</a></dt>
<dd><p>Fixture to provide different O(3) sigma values for
testing spherical tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>FixtureRequest</em>) – The pytest request fixture.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The O(3) sigma value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.dataset_info_spherical">
<span class="sig-name descname"><span class="pre">dataset_info_spherical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o3_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">o3_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.dataset_info_spherical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.dataset_info_spherical" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides a basic <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> with a
spherical target for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>o3_lambda</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The O(3) lambda of the spherical target.</p></li>
<li><p><strong>o3_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The O(3) sigma of the spherical target.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> instance with a spherical target.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.dataset_info_multispherical">
<span class="sig-name descname"><span class="pre">dataset_info_multispherical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.dataset_info_multispherical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.dataset_info_multispherical" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides a basic <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> with multiple spherical
targets for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether the target is per-atom or not.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">DatasetInfo</span></code> instance with a multiple spherical targets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.model_cls">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_cls</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></em><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.model_cls" title="Link to this definition">¶</a></dt>
<dd><p>The model class to be tested.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.trainer_cls">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trainer_cls</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><span class="pre">TrainerInterface</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.trainer_cls" title="Link to this definition">¶</a></dt>
<dd><p>The trainer class to be tested.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.default_hypers">
<span class="sig-name descname"><span class="pre">default_hypers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.default_hypers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.default_hypers" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides the default hyperparameters for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default hyperparameters for the architecture.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.model_hypers">
<span class="sig-name descname"><span class="pre">model_hypers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.model_hypers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.model_hypers" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that provides the model hyperparameters for testing.</p>
<p>If not overriden, these are the default model hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The model hyperparameters for testing.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ArchitectureTests.minimal_model_hypers">
<span class="sig-name descname"><span class="pre">minimal_model_hypers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/architectures.html#ArchitectureTests.minimal_model_hypers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ArchitectureTests.minimal_model_hypers" title="Link to this definition">¶</a></dt>
<dd><p>The hypers that produce the smallest possible model.</p>
<p>This should be overridden in each architecture test class
to ensure that the tests run quickly/checkpoints occupy
little disk space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The minimal model hyperparameters for testing.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-metatrain.utils.testing">
<span id="test-suites-for-each-functionality"></span><h2>Test suites for each functionality<a class="headerlink" href="#module-metatrain.utils.testing" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.testing.AutogradTests">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.testing.</span></span><span class="sig-name descname"><span class="pre">AutogradTests</span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/autograd.html#AutogradTests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.AutogradTests" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests" title="metatrain.utils.testing.architectures.ArchitectureTests"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArchitectureTests</span></code></a></p>
<p>Tests that autograd works correctly for a given model.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.AutogradTests.cell_param">
<span class="sig-name descname"><span class="pre">cell_param</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2.0</span></em><a class="headerlink" href="#metatrain.utils.testing.AutogradTests.cell_param" title="Link to this definition">¶</a></dt>
<dd><p>The system created for testing autograd is a cubic cell.</p>
<p>These parameter controls the size of each cell vector.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.AutogradTests.cuda_nondet_tolerance">
<span class="sig-name descname"><span class="pre">cuda_nondet_tolerance</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#metatrain.utils.testing.AutogradTests.cuda_nondet_tolerance" title="Link to this definition">¶</a></dt>
<dd><p>Some operations in your model might be nondeterministic in CuBLAS.</p>
<p>This can result in small differences in two gradient computations
with the same input and outputs. This number sets the nondeterministic
tolerance for <code class="docutils literal notranslate"><span class="pre">gradcheck</span></code> and <code class="docutils literal notranslate"><span class="pre">gradgradcheck</span></code> when running on CUDA.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.AutogradTests.positions">
<span class="sig-name descname"><span class="pre">positions</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0],</span> <span class="pre">[0.9,</span> <span class="pre">0.9,</span> <span class="pre">0.9]]</span></em><a class="headerlink" href="#metatrain.utils.testing.AutogradTests.positions" title="Link to this definition">¶</a></dt>
<dd><p>Positions used to create the system for testing autograd.</p>
<p>We create a system with two carbon atoms in these positions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.AutogradTests.test_autograd_cell">
<span class="sig-name descname"><span class="pre">test_autograd_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><span class="pre">device</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/autograd.html#AutogradTests.test_autograd_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.AutogradTests.test_autograd_cell" title="Link to this definition">¶</a></dt>
<dd><p>Tests that autograd can compute gradients with respect to
the cell.</p>
<p>It checks both first and second derivatives.</p>
<p>It uses <code class="docutils literal notranslate"><span class="pre">torch.autograd.gradcheck</span></code> and
<code class="docutils literal notranslate"><span class="pre">torch.autograd.gradgradcheck</span></code> for this purpose.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>device</em></a>) – The device to run the test on.</p></li>
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.AutogradTests.test_autograd_positions">
<span class="sig-name descname"><span class="pre">test_autograd_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><span class="pre">device</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/autograd.html#AutogradTests.test_autograd_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.AutogradTests.test_autograd_positions" title="Link to this definition">¶</a></dt>
<dd><p>Tests that autograd can compute gradients with respect to
positions.</p>
<p>It checks both first and second derivatives.</p>
<p>It uses <code class="docutils literal notranslate"><span class="pre">torch.autograd.gradcheck</span></code> and
<code class="docutils literal notranslate"><span class="pre">torch.autograd.gradgradcheck</span></code> for this purpose.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>device</em></a>) – The device to run the test on.</p></li>
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.testing.CheckpointTests">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.testing.</span></span><span class="sig-name descname"><span class="pre">CheckpointTests</span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/checkpoints.html#CheckpointTests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.CheckpointTests" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests" title="metatrain.utils.testing.architectures.ArchitectureTests"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArchitectureTests</span></code></a></p>
<p>Test suite for model and trainer checkpoints.</p>
<p>This test suite verifies that the checkpoints for the architecture
follow the expected behavior of <code class="docutils literal notranslate"><span class="pre">metatrain</span></code> checkpoints.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.CheckpointTests.incompatible_trainer_checkpoints">
<span class="sig-name descname"><span class="pre">incompatible_trainer_checkpoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#metatrain.utils.testing.CheckpointTests.incompatible_trainer_checkpoints" title="Link to this definition">¶</a></dt>
<dd><p>A list of checkpoint paths that are known
to be incompatible with the current trainer version when restarting.</p>
<p>This should be overriden in subclasses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.CheckpointTests.model_trainer">
<span class="sig-name descname"><span class="pre">model_trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimal_model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><span class="pre">ModelInterface</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><span class="pre">TrainerInterface</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/checkpoints.html#CheckpointTests.model_trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.CheckpointTests.model_trainer" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that returns a trained model and trainer.</p>
<p>The model and trainer are used in the test suite to verify checkpoint
functionality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The path to the dataset file to train on.</p></li>
<li><p><strong>dataset_targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – The targets that the dataset contains.</p></li>
<li><p><strong>minimal_model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.
These should give the smallest possible model to use as little
disk space as possible when saving checkpoints.</p></li>
<li><p><strong>default_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Default hyperparameters to initialize the trainer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the trained model and the trainer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>[<a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><em>ModelInterface</em></a>, <a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><em>TrainerInterface</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.CheckpointTests.test_checkpoint_did_not_change">
<span class="sig-name descname"><span class="pre">test_checkpoint_did_not_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><span class="pre">ModelInterface</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><span class="pre">TrainerInterface</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/checkpoints.html#CheckpointTests.test_checkpoint_did_not_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.CheckpointTests.test_checkpoint_did_not_change" title="Link to this definition">¶</a></dt>
<dd><p>Test that the checkpoint did not change.</p>
<p>This test gets the current version of the model and trainer,
and loads the checkpoint for that version from the <code class="docutils literal notranslate"><span class="pre">checkpoints/</span></code>
folder. If that checkpoint is not compatible with the current code,
this means that the checkpoint version of either the model or the
trainer needs to be bumped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monkeypatch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a>) – The pytest monkeypatch fixture.</p></li>
<li><p><strong>tmp_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The pytest tmp_path fixture.</p></li>
<li><p><strong>model_trainer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><em>ModelInterface</em></a><em>, </em><a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><em>TrainerInterface</em></a><em>]</em>) – Model and trainer to test.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.CheckpointTests.test_failed_checkpoint_upgrade">
<span class="sig-name descname"><span class="pre">test_failed_checkpoint_upgrade</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'model'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'trainer'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/checkpoints.html#CheckpointTests.test_failed_checkpoint_upgrade"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.CheckpointTests.test_failed_checkpoint_upgrade" title="Link to this definition">¶</a></dt>
<dd><p>Test error raised when trying to upgrade an invalid checkpoint version.</p>
<p>This test creates a checkpoint with an invalid version number and
tries to upgrade it using the corresponding class.</p>
<p>If this test fails, it likely means that you are not raising the
error in your model/trainer’s <code class="docutils literal notranslate"><span class="pre">upgrade_checkpoint</span></code> method when
the checkpoint version is not recognized. To raise the appropiate
error:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cls_type</span> <span class="o">=</span> <span class="s2">&quot;model&quot;</span>  <span class="c1"># or &quot;trainer&quot;</span>

<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Unable to upgrade the checkpoint: the checkpoint is using </span><span class="si">{</span><span class="n">cls_type</span><span class="si">}</span><span class="s2"> &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;version </span><span class="si">{</span><span class="n">checkpoint_version</span><span class="si">}</span><span class="s2">, while the current </span><span class="si">{</span><span class="n">cls_type</span><span class="si">}</span><span class="s2"> version &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__checkpoint_version__</span><span class="si">}</span><span class="s2">.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cls_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><em>Literal</em></a><em>[</em><em>'model'</em><em>, </em><em>'trainer'</em><em>]</em>) – The class type to test.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.CheckpointTests.test_get_checkpoint">
<span class="sig-name descname"><span class="pre">test_get_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'finetune'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'restart'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'export'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caplog</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><span class="pre">ModelInterface</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><span class="pre">TrainerInterface</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/checkpoints.html#CheckpointTests.test_get_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.CheckpointTests.test_get_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Test that the checkpoint created by the <code class="docutils literal notranslate"><span class="pre">model.get_checkpoint()</span></code>
function can be loaded back in all possible contexts.</p>
<p>This test can fail either if the model is unable to produce
checkpoints, or if the generated checkpoint can’t be loaded back
by the model in the specified context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><em>Literal</em></a><em>[</em><em>'finetune'</em><em>, </em><em>'restart'</em><em>, </em><em>'export'</em><em>]</em>) – The context in which to load the generated checkpoint.</p></li>
<li><p><strong>caplog</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a>) – The pytest caplog fixture.</p></li>
<li><p><strong>model_trainer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><em>ModelInterface</em></a><em>, </em><a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><em>TrainerInterface</em></a><em>]</em>) – Model and trainer to be used for the test.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.CheckpointTests.test_loading_old_checkpoints">
<span class="sig-name descname"><span class="pre">test_loading_old_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><span class="pre">ModelInterface</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><span class="pre">TrainerInterface</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'restart'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'finetune'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'export'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/checkpoints.html#CheckpointTests.test_loading_old_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.CheckpointTests.test_loading_old_checkpoints" title="Link to this definition">¶</a></dt>
<dd><p>Tests that checkpoints from previous versions can be loaded.</p>
<p>This test goes through all the checkpoint files in the
<code class="docutils literal notranslate"><span class="pre">checkpoints/</span></code> folder of the current directory (presumably the
architecture’s tests folder) and tries to load them in the current
model and trainer.</p>
<p>The test skips trainer checkpoints that are listed in this class’s
<code class="docutils literal notranslate"><span class="pre">incompatible_trainer_checkpoints</span></code> attribute when the context is
<code class="docutils literal notranslate"><span class="pre">restart</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>default_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Default hyperparameters to initialize the trainer.</p></li>
<li><p><strong>model_trainer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><em>ModelInterface</em></a><em>, </em><a class="reference internal" href="abc.html#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><em>TrainerInterface</em></a><em>]</em>) – Model and trainer to be used for loading the checkpoints.</p></li>
<li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><em>Literal</em></a><em>[</em><em>'restart'</em><em>, </em><em>'finetune'</em><em>, </em><em>'export'</em><em>]</em>) – The context in which to load the checkpoint.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.testing.ExportedTests">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.testing.</span></span><span class="sig-name descname"><span class="pre">ExportedTests</span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/exported.html#ExportedTests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ExportedTests" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests" title="metatrain.utils.testing.architectures.ArchitectureTests"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArchitectureTests</span></code></a></p>
<p>Test suite to test exported models.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.ExportedTests.avoid_consistency_check">
<span class="sig-name descname"><span class="pre">avoid_consistency_check</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#metatrain.utils.testing.ExportedTests.avoid_consistency_check" title="Link to this definition">¶</a></dt>
<dd><p>List of output names for which to avoid consistency checks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.ExportedTests.test_to">
<span class="sig-name descname"><span class="pre">test_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><span class="pre">device</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><span class="pre">dtype</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/exported.html#ExportedTests.test_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.ExportedTests.test_to" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the <cite>.to()</cite> method of the exported model works.</p>
<p>In other words, it tests that the exported model can be moved to
different devices and dtypes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>device</em></a>) – The device to move the exported model to.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><em>dtype</em></a>) – The dtype to move the exported model to.</p></li>
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.testing.InputTests">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.testing.</span></span><span class="sig-name descname"><span class="pre">InputTests</span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/input.html#InputTests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.InputTests" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests" title="metatrain.utils.testing.architectures.ArchitectureTests"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArchitectureTests</span></code></a></p>
<p>Test suite to check that the model handles inputs correctly.</p>
<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.InputTests.test_atomic_baseline">
<span class="sig-name descname"><span class="pre">test_atomic_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/input.html#InputTests.test_atomic_baseline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.InputTests.test_atomic_baseline" title="Link to this definition">¶</a></dt>
<dd><p>Test that the trainer can accept atomic baselines.</p>
<p>The tests checks that when providing valid atomic baselines,
the architecture options are accepted.</p>
<p>This test is skipped if the architecture’s trainer does not use
<code class="docutils literal notranslate"><span class="pre">atomic_baseline</span></code>.
If this test is failing you need to add the correct type hint to
the <code class="docutils literal notranslate"><span class="pre">atomic_baseline</span></code> field of the trainer hypers.
I.e., in <code class="docutils literal notranslate"><span class="pre">documentation.py</span></code> of your architecture:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing_extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypedDict</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">metatrain.utils.additive</span><span class="w"> </span><span class="kn">import</span> <span class="n">FixedCompositionWeights</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TrainerHypers</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="o">...</span>  <span class="c1"># Rest of hyperparameters</span>
    <span class="n">atomic_baseline</span><span class="p">:</span> <span class="n">FixedCompositionWeights</span>
</pre></div>
</div>
<p>with the appropiate documentation and default if applicable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>default_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – The default hyperparameters for the architecture.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.InputTests.test_atomic_baseline_error">
<span class="sig-name descname"><span class="pre">test_atomic_baseline_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/input.html#InputTests.test_atomic_baseline_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.InputTests.test_atomic_baseline_error" title="Link to this definition">¶</a></dt>
<dd><p>Test that invalid input is not accepted for <code class="docutils literal notranslate"><span class="pre">atomic_baseline</span></code>.</p>
<p>The tests checks that when providing invalid atomic baselines,
the architecture options raise a validation error.</p>
<p>This test is skipped if the architecture’s trainer does not use
<code class="docutils literal notranslate"><span class="pre">atomic_baseline</span></code>.</p>
<p>If this test is failing you need to add the correct type hint to
the <code class="docutils literal notranslate"><span class="pre">atomic_baseline</span></code> field of the trainer hypers.
I.e., in <code class="docutils literal notranslate"><span class="pre">documentation.py</span></code> of your architecture:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing_extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypedDict</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">metatrain.utils.additive</span><span class="w"> </span><span class="kn">import</span> <span class="n">FixedCompositionWeights</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TrainerHypers</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="o">...</span>  <span class="c1"># Rest of hyperparameters</span>
    <span class="n">atomic_baseline</span><span class="p">:</span> <span class="n">FixedCompositionWeights</span>
</pre></div>
</div>
<p>with the appropiate documentation and default if applicable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>default_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – The default hyperparameters for the architecture.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.testing.</span></span><span class="sig-name descname"><span class="pre">OutputTests</span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests" title="metatrain.utils.testing.architectures.ArchitectureTests"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArchitectureTests</span></code></a></p>
<p>Test suite to check that the model can produce different types of outputs.</p>
<p>If a model does not support a given type of output, set the corresponding
<code class="docutils literal notranslate"><span class="pre">supports_*_outputs</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">False</span></code> to skip the corresponding tests.
By default, they are all set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to avoid supported outputs from
being untested accidentally.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.is_equivariant_model">
<span class="sig-name descname"><span class="pre">is_equivariant_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.utils.testing.OutputTests.is_equivariant_model" title="Link to this definition">¶</a></dt>
<dd><p>Whether the model is equivariant (i.e. produces outputs that
transform correctly under rotations by architecture’s design).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.n_features">
<span class="sig-name descname"><span class="pre">n_features</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.n_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.n_features" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that returns the number of features produced by the model.</p>
<p>By default this is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, which skips checking the number
of features in the output. Override this fixture for your architecture
if you want the test suite to check that the number of features in the
output is correct.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of features produced by the model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>] | <em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.n_last_layer_features">
<span class="sig-name descname"><span class="pre">n_last_layer_features</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.n_last_layer_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.n_last_layer_features" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that returns the number of last-layer features produced
by the model.</p>
<p>By default this is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, which skips checking the number
of last-layer features in the output. Override this fixture for your
architecture if you want the test suite to check that the number of
last-layer features in the output is correct.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of last-layer features produced by the model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a> | <em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.single_atom_energy">
<span class="sig-name descname"><span class="pre">single_atom_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.single_atom_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.single_atom_energy" title="Link to this definition">¶</a></dt>
<dd><p>Fixture that returns the single atom energy value.</p>
<p>By default this is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, which skips checking the single
atom energy value in the output. Override this fixture for your
architecture if you want the test suite to check that the single atom
energy value in the output is correct.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The single atom energy value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a> | <em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.supports_features">
<span class="sig-name descname"><span class="pre">supports_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.utils.testing.OutputTests.supports_features" title="Link to this definition">¶</a></dt>
<dd><p>Whether the model supports returning features.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.supports_last_layer_features">
<span class="sig-name descname"><span class="pre">supports_last_layer_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.utils.testing.OutputTests.supports_last_layer_features" title="Link to this definition">¶</a></dt>
<dd><p>Whether the model supports returning last-layer features.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.supports_scalar_outputs">
<span class="sig-name descname"><span class="pre">supports_scalar_outputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.utils.testing.OutputTests.supports_scalar_outputs" title="Link to this definition">¶</a></dt>
<dd><p>Whether the model supports scalar outputs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.supports_selected_atoms">
<span class="sig-name descname"><span class="pre">supports_selected_atoms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.utils.testing.OutputTests.supports_selected_atoms" title="Link to this definition">¶</a></dt>
<dd><p>Whether the model supports the <code class="docutils literal notranslate"><span class="pre">selected_atoms</span></code> argument in the
<code class="docutils literal notranslate"><span class="pre">forward()</span></code> method.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.supports_spherical_outputs">
<span class="sig-name descname"><span class="pre">supports_spherical_outputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.utils.testing.OutputTests.supports_spherical_outputs" title="Link to this definition">¶</a></dt>
<dd><p>Whether the model supports spherical tensor outputs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.supports_vector_outputs">
<span class="sig-name descname"><span class="pre">supports_vector_outputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.utils.testing.OutputTests.supports_vector_outputs" title="Link to this definition">¶</a></dt>
<dd><p>Whether the model supports vector outputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_features">
<span class="sig-name descname"><span class="pre">test_output_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_features" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can output its learned features.</p>
<p>If this test is failing you are probably not exposing correctly
the features output in your model.</p>
<p>This test is skipped if the model does not support features output,
i.e., if <code class="docutils literal notranslate"><span class="pre">supports_features</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
<li><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to request per-atom features or not.</p></li>
<li><p><strong>n_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] </em><em>| </em><em>None</em>) – Expected number of features. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the number
of features is not checked.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_last_layer_features">
<span class="sig-name descname"><span class="pre">test_output_last_layer_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_last_layer_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_last_layer_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_last_layer_features" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can output its last layer features.</p>
<p>If this test is failing you are probably not exposing correctly
the last-layer features output in your model.</p>
<p>This test is skipped if the model does not support last-layer features
output, i.e., if <code class="docutils literal notranslate"><span class="pre">supports_last_layer_features</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
<li><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to request per-atom last-layer features or not.</p></li>
<li><p><strong>n_last_layer_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em>) – Expected number of last-layer features.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the number of last-layer features is not checked.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_last_layer_features_selected_atoms">
<span class="sig-name descname"><span class="pre">test_output_last_layer_features_selected_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_last_layer_features_selected_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_last_layer_features_selected_atoms" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can output its last layer features for selected atoms.</p>
<p>This test is skipped if the model does not support last-layer features
or the model does not support the <code class="docutils literal notranslate"><span class="pre">selected_atoms</span></code> argument of the
<code class="docutils literal notranslate"><span class="pre">forward()</span></code> method, i.e. if either <code class="docutils literal notranslate"><span class="pre">supports_last_layer_features</span></code>
or <code class="docutils literal notranslate"><span class="pre">supports_selected_atoms</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to a dataset file to read systems from.</p></li>
<li><p><strong>select_atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>]</em>) – List of atom indices to select for the output.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_multispherical">
<span class="sig-name descname"><span class="pre">test_output_multispherical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info_multispherical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_multispherical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_multispherical" title="Link to this definition">¶</a></dt>
<dd><p>Tests that forward pass works for spherical tensor outputs
with multiple irreps.</p>
<p>It also tests that the returned outputs have the expected samples
and values shape.</p>
<p>This test is skipped if the model does not support spherical outputs,
i.e., if <code class="docutils literal notranslate"><span class="pre">supports_spherical_outputs</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>If this test is failing and <code class="docutils literal notranslate"><span class="pre">test_output_spherical</span></code> is passing, your model
probably is not handling the possibility that spherical outputs can have
multiple irreps.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">test_output_spherical</span></code> is also failing, fix that test first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info_multispherical</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information with multiple
spherical outputs.</p></li>
<li><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether the requested outputs are per-atom or not.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_scalar">
<span class="sig-name descname"><span class="pre">test_output_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info_scalar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_scalar" title="Link to this definition">¶</a></dt>
<dd><p>Tests that forward pass works for scalar outputs.</p>
<p>It also tests that the returned outputs have the expected samples
and values shape.</p>
<p>This test is skipped if the model does not support scalar outputs,
i.e., if <code class="docutils literal notranslate"><span class="pre">supports_scalar_outputs</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>If this test is failing, your model might:</p>
<ul class="simple">
<li><p>not be producing scalar outputs when requested.</p></li>
<li><p>not be taking into account correctly the <code class="docutils literal notranslate"><span class="pre">per_atom</span></code> field of the
outputs passed to the <code class="docutils literal notranslate"><span class="pre">outputs</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">forward()</span></code> method.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info_scalar</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information with scalar outputs.</p></li>
<li><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether the requested outputs are per-atom or not.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_scalar_invariant">
<span class="sig-name descname"><span class="pre">test_output_scalar_invariant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_scalar_invariant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_scalar_invariant" title="Link to this definition">¶</a></dt>
<dd><p>Tests that scalar outputs are invariant to rotation.</p>
<p>This test is skipped if the model does not support scalar outputs,
or if the model is not equivariant by design, i.e., if either
<code class="docutils literal notranslate"><span class="pre">supports_scalar_outputs</span></code> or <code class="docutils literal notranslate"><span class="pre">is_equivariant_model</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to a dataset file to read systems from.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_spherical">
<span class="sig-name descname"><span class="pre">test_output_spherical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info_spherical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_spherical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_spherical" title="Link to this definition">¶</a></dt>
<dd><p>Tests that forward pass works for spherical outputs.</p>
<p>It also tests that the returned outputs have the expected samples
and values shape.</p>
<p>This test is skipped if the model does not support spherical outputs,
i.e., if <code class="docutils literal notranslate"><span class="pre">supports_spherical_outputs</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>If this test is failing, your model might:
- not be producing spherical outputs when requested.
- not be taking into account correctly the <code class="docutils literal notranslate"><span class="pre">per_atom</span></code> field of the
outputs passed to the <code class="docutils literal notranslate"><span class="pre">outputs</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">forward()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info_spherical</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information with spherical outputs.</p></li>
<li><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether the requested outputs are per-atom or not.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_spherical_equivariant_inversion">
<span class="sig-name descname"><span class="pre">test_output_spherical_equivariant_inversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info_spherical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">o3_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">o3_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_spherical_equivariant_inversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_spherical_equivariant_inversion" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model is equivariant with respect to inversions.</p>
<p>This test is done on spherical targets (not scalar targets).</p>
<p>This test is skipped if the model does not support spherical outputs,
or if the model is not equivariant by design, i.e., if either
<code class="docutils literal notranslate"><span class="pre">supports_spherical_outputs</span></code> or <code class="docutils literal notranslate"><span class="pre">is_equivariant_model</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info_spherical</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information with spherical outputs.</p></li>
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to a dataset file to read systems from.</p></li>
<li><p><strong>o3_lambda</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The O(3) lambda of the spherical output to test.</p></li>
<li><p><strong>o3_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The O(3) sigma of the spherical output to test.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_spherical_equivariant_rotations">
<span class="sig-name descname"><span class="pre">test_output_spherical_equivariant_rotations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info_spherical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_spherical_equivariant_rotations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_spherical_equivariant_rotations" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model is rotationally equivariant when predicting
spherical tensors.</p>
<p>This test is skipped if the model does not support spherical outputs,
or if the model is not equivariant by design, i.e., if either
<code class="docutils literal notranslate"><span class="pre">supports_spherical_outputs</span></code> or <code class="docutils literal notranslate"><span class="pre">is_equivariant_model</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info_spherical</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information with spherical outputs.</p></li>
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to a dataset file to read systems from.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_output_vector">
<span class="sig-name descname"><span class="pre">test_output_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info_vector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_output_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_output_vector" title="Link to this definition">¶</a></dt>
<dd><p>Tests that forward pass works for vector outputs.</p>
<p>It also tests that the returned outputs have the expected samples
and values shape.</p>
<p>This test is skipped if the model does not support vector outputs,
i.e., if <code class="docutils literal notranslate"><span class="pre">supports_vector_outputs</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>If this test is failing, your model might:
- not be producing vector outputs when requested.
- not be taking into account correctly the <code class="docutils literal notranslate"><span class="pre">per_atom</span></code> field of the
outputs passed to the <code class="docutils literal notranslate"><span class="pre">outputs</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">forward()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info_vector</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information with vector outputs.</p></li>
<li><p><strong>per_atom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether the requested outputs are per-atom or not.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_prediction_energy_subset_atoms">
<span class="sig-name descname"><span class="pre">test_prediction_energy_subset_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_prediction_energy_subset_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_prediction_energy_subset_atoms" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can predict on a subset
of the atoms in a system.</p>
<p>This test checks that the model supports the <code class="docutils literal notranslate"><span class="pre">selected_atoms</span></code>
argument of the <code class="docutils literal notranslate"><span class="pre">forward()</span></code> method, and it handles it correctly.
That is, the model only returns outputs for the selected atoms.</p>
<p>This test is skipped if the model does not support the <code class="docutils literal notranslate"><span class="pre">selected_atoms</span></code>
argument of the <code class="docutils literal notranslate"><span class="pre">forward()</span></code> method, i.e., if <code class="docutils literal notranslate"><span class="pre">supports_selected_atoms</span></code>
is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_prediction_energy_subset_elements">
<span class="sig-name descname"><span class="pre">test_prediction_energy_subset_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_prediction_energy_subset_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_prediction_energy_subset_elements" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can predict on a subset of the elements it was trained
on.</p>
<p>If this test is failing, it means that your model needs each system
to contain all the elements that are present in the dataset.
If this is the expected behavior for your model, we need to introduce
a variable to skip this test, contact the <code class="docutils literal notranslate"><span class="pre">metatrain</span></code> developers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.OutputTests.test_single_atom">
<span class="sig-name descname"><span class="pre">test_single_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_atom_energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/output.html#OutputTests.test_single_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.OutputTests.test_single_atom" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model runs fine on a single atom system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset information to initialize the model.</p></li>
<li><p><strong>single_atom_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> | </em><em>None</em>) – Expected single atom energy value. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
the single atom energy value is not checked.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.testing.TorchscriptTests">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.testing.</span></span><span class="sig-name descname"><span class="pre">TorchscriptTests</span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/torchscript.html#TorchscriptTests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TorchscriptTests" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests" title="metatrain.utils.testing.architectures.ArchitectureTests"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArchitectureTests</span></code></a></p>
<p>Test suite to check that architectures can be jit compiled with
TorchScript.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.TorchscriptTests.float_hypers">
<span class="sig-name descname"><span class="pre">float_hypers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#metatrain.utils.testing.TorchscriptTests.float_hypers" title="Link to this definition">¶</a></dt>
<dd><p>List of hyperparameter keys (dot-separated for nested keys)
that are floats. A test will set these to integers to test that
TorchScript compilation works in that case.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TorchscriptTests.jit_compile">
<span class="sig-name descname"><span class="pre">jit_compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><span class="pre">ModelInterface</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.jit.ScriptModule.html#torch.jit.ScriptModule" title="(in PyTorch v2.10)"><span class="pre">ScriptModule</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/torchscript.html#TorchscriptTests.jit_compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TorchscriptTests.jit_compile" title="Link to this definition">¶</a></dt>
<dd><p>JIT compiles the given model.</p>
<p>The default is to simply torch.jit.script the model, but
architectures can override this method if some special
compilation procedure is needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="abc.html#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><em>ModelInterface</em></a>) – Model to compile.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JIT compiled model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.jit.ScriptModule.html#torch.jit.ScriptModule" title="(in PyTorch v2.10)"><em>ScriptModule</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TorchscriptTests.test_torchscript">
<span class="sig-name descname"><span class="pre">test_torchscript</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><span class="pre">dtype</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/torchscript.html#TorchscriptTests.test_torchscript"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can be jitted.</p>
<p>If this test fails it probably means that there is some
code in the model that is not compatible with TorchScript.
The exception raised by the test should indicate where
the problem is.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset to initialize the model.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><em>dtype</em></a>) – Dtype to use for the model and inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TorchscriptTests.test_torchscript_dtypechange">
<span class="sig-name descname"><span class="pre">test_torchscript_dtypechange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><span class="pre">dtype</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/torchscript.html#TorchscriptTests.test_torchscript_dtypechange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript_dtypechange" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can be changed to a different dtype after jitting.</p>
<p>If this test fails and <code class="docutils literal notranslate"><span class="pre">test_torchscript</span></code> passes, it probably means that
your model is overwriting the <cite>to()</cite> method, which does not work in
TorchScript. If <code class="docutils literal notranslate"><span class="pre">test_torchscript</span></code> also fails, then one should fix
that one first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset to initialize the model.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><em>dtype</em></a>) – Dtype to change the model to.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TorchscriptTests.test_torchscript_integers">
<span class="sig-name descname"><span class="pre">test_torchscript_integers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/torchscript.html#TorchscriptTests.test_torchscript_integers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript_integers" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can be jitted when some float
parameters are instead supplied as integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TorchscriptTests.test_torchscript_save_load">
<span class="sig-name descname"><span class="pre">test_torchscript_save_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmpdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/torchscript.html#TorchscriptTests.test_torchscript_save_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript_save_load" title="Link to this definition">¶</a></dt>
<dd><p>Tests that the model can be jitted, saved and loaded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tmpdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a>) – Temporary directory where to save the
model.</p></li>
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TorchscriptTests.test_torchscript_spherical">
<span class="sig-name descname"><span class="pre">test_torchscript_spherical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info_spherical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/torchscript.html#TorchscriptTests.test_torchscript_spherical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript_spherical" title="Link to this definition">¶</a></dt>
<dd><p>Tests that there is no problem with jitting with spherical targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to initialize the model.</p></li>
<li><p><strong>dataset_info_spherical</strong> (<a class="reference internal" href="data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>) – Dataset to initialize the model
(containing spherical targets).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.testing.TrainingTests">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.testing.</span></span><span class="sig-name descname"><span class="pre">TrainingTests</span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/training.html#TrainingTests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TrainingTests" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests" title="metatrain.utils.testing.architectures.ArchitectureTests"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArchitectureTests</span></code></a></p>
<p>Puts architectures to test in real training scenarios.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.testing.TrainingTests.check_gradients">
<span class="sig-name descname"><span class="pre">check_gradients</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#metatrain.utils.testing.TrainingTests.check_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TrainingTests.test_continue">
<span class="sig-name descname"><span class="pre">test_continue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/training.html#TrainingTests.test_continue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TrainingTests.test_continue" title="Link to this definition">¶</a></dt>
<dd><p>Tests that a model can be checkpointed and loaded
for a continuation of the training process</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monkeypatch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a>) – Pytest fixture to modify the current working
directory.</p></li>
<li><p><strong>tmp_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><em>Path</em></a>) – Temporary path to use for saving checkpoints.</p></li>
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to the dataset to use for training.</p></li>
<li><p><strong>dataset_targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>]</em>) – Target hypers for the targets in the dataset.</p></li>
<li><p><strong>default_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a><em>]</em>) – Default hyperparameters for the architecture.</p></li>
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a><em>]</em>) – Hyperparameters to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TrainingTests.test_continue_finetune_num_epochs">
<span class="sig-name descname"><span class="pre">test_continue_finetune_num_epochs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/training.html#TrainingTests.test_continue_finetune_num_epochs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TrainingTests.test_continue_finetune_num_epochs" title="Link to this definition">¶</a></dt>
<dd><p>Tests that a training finetune runs the correct
number of epochs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monkeypatch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a>) – Pytest fixture to modify the current working
directory.</p></li>
<li><p><strong>tmp_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><em>Path</em></a>) – Temporary path to use for saving checkpoints.</p></li>
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to the dataset to use for training.</p></li>
<li><p><strong>dataset_targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>]</em>) – Target hypers for the targets in the dataset.</p></li>
<li><p><strong>default_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a><em>]</em>) – Default hyperparameters for the architecture.</p></li>
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a><em>]</em>) – Hyperparameters to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.testing.TrainingTests.test_continue_restart_num_epochs">
<span class="sig-name descname"><span class="pre">test_continue_restart_num_epochs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monkeypatch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../_modules/metatrain/utils/testing/training.html#TrainingTests.test_continue_restart_num_epochs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.testing.TrainingTests.test_continue_restart_num_epochs" title="Link to this definition">¶</a></dt>
<dd><p>Tests that a training restart runs the correct
number of epochs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monkeypatch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a>) – Pytest fixture to modify the current working
directory.</p></li>
<li><p><strong>tmp_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><em>Path</em></a>) – Temporary path to use for saving checkpoints.</p></li>
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to the dataset to use for training.</p></li>
<li><p><strong>dataset_targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>]</em>) – Target hypers for the targets in the dataset.</p></li>
<li><p><strong>default_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a><em>]</em>) – Default hyperparameters for the architecture.</p></li>
<li><p><strong>model_hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><em>Any</em></a><em>]</em>) – Hyperparameters to initialize the model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="transfer.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Data type and device transfers</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="sum_over_atoms.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Summing over atoms</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2026, metatrain developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-github fa-2x" href="https://github.com/metatensor/metatrain" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Testing Utilities</a><ul>
<li><a class="reference internal" href="#the-base-class-for-tests">The base class for tests</a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.architecture"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.architecture</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.dataset_path"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.dataset_path()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.dataset_targets"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.dataset_targets()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.get_dataset"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.get_dataset()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.device"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.device()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.dtype"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.dtype()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.dataset_info"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.dataset_info()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.per_atom"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.per_atom()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.dataset_info_scalar"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.dataset_info_scalar()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.dataset_info_vector"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.dataset_info_vector()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.o3_lambda"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.o3_lambda()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.o3_sigma"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.o3_sigma()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.dataset_info_spherical"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.dataset_info_spherical()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.dataset_info_multispherical"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.dataset_info_multispherical()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.model_cls"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.model_cls</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.trainer_cls"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.trainer_cls</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.default_hypers"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.default_hypers()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.model_hypers"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.model_hypers()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ArchitectureTests.minimal_model_hypers"><code class="docutils literal notranslate"><span class="pre">ArchitectureTests.minimal_model_hypers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-metatrain.utils.testing">Test suites for each functionality</a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.AutogradTests"><code class="docutils literal notranslate"><span class="pre">AutogradTests</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.AutogradTests.cell_param"><code class="docutils literal notranslate"><span class="pre">AutogradTests.cell_param</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.AutogradTests.cuda_nondet_tolerance"><code class="docutils literal notranslate"><span class="pre">AutogradTests.cuda_nondet_tolerance</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.AutogradTests.positions"><code class="docutils literal notranslate"><span class="pre">AutogradTests.positions</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.AutogradTests.test_autograd_cell"><code class="docutils literal notranslate"><span class="pre">AutogradTests.test_autograd_cell()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.AutogradTests.test_autograd_positions"><code class="docutils literal notranslate"><span class="pre">AutogradTests.test_autograd_positions()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#metatrain.utils.testing.CheckpointTests"><code class="docutils literal notranslate"><span class="pre">CheckpointTests</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.CheckpointTests.incompatible_trainer_checkpoints"><code class="docutils literal notranslate"><span class="pre">CheckpointTests.incompatible_trainer_checkpoints</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.CheckpointTests.model_trainer"><code class="docutils literal notranslate"><span class="pre">CheckpointTests.model_trainer()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.CheckpointTests.test_checkpoint_did_not_change"><code class="docutils literal notranslate"><span class="pre">CheckpointTests.test_checkpoint_did_not_change()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.CheckpointTests.test_failed_checkpoint_upgrade"><code class="docutils literal notranslate"><span class="pre">CheckpointTests.test_failed_checkpoint_upgrade()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.CheckpointTests.test_get_checkpoint"><code class="docutils literal notranslate"><span class="pre">CheckpointTests.test_get_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.CheckpointTests.test_loading_old_checkpoints"><code class="docutils literal notranslate"><span class="pre">CheckpointTests.test_loading_old_checkpoints()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#metatrain.utils.testing.ExportedTests"><code class="docutils literal notranslate"><span class="pre">ExportedTests</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.ExportedTests.avoid_consistency_check"><code class="docutils literal notranslate"><span class="pre">ExportedTests.avoid_consistency_check</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.ExportedTests.test_to"><code class="docutils literal notranslate"><span class="pre">ExportedTests.test_to()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#metatrain.utils.testing.InputTests"><code class="docutils literal notranslate"><span class="pre">InputTests</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.InputTests.test_atomic_baseline"><code class="docutils literal notranslate"><span class="pre">InputTests.test_atomic_baseline()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.InputTests.test_atomic_baseline_error"><code class="docutils literal notranslate"><span class="pre">InputTests.test_atomic_baseline_error()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests"><code class="docutils literal notranslate"><span class="pre">OutputTests</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.is_equivariant_model"><code class="docutils literal notranslate"><span class="pre">OutputTests.is_equivariant_model</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.n_features"><code class="docutils literal notranslate"><span class="pre">OutputTests.n_features()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.n_last_layer_features"><code class="docutils literal notranslate"><span class="pre">OutputTests.n_last_layer_features()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.single_atom_energy"><code class="docutils literal notranslate"><span class="pre">OutputTests.single_atom_energy()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.supports_features"><code class="docutils literal notranslate"><span class="pre">OutputTests.supports_features</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.supports_last_layer_features"><code class="docutils literal notranslate"><span class="pre">OutputTests.supports_last_layer_features</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.supports_scalar_outputs"><code class="docutils literal notranslate"><span class="pre">OutputTests.supports_scalar_outputs</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.supports_selected_atoms"><code class="docutils literal notranslate"><span class="pre">OutputTests.supports_selected_atoms</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.supports_spherical_outputs"><code class="docutils literal notranslate"><span class="pre">OutputTests.supports_spherical_outputs</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.supports_vector_outputs"><code class="docutils literal notranslate"><span class="pre">OutputTests.supports_vector_outputs</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_features"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_features()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_last_layer_features"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_last_layer_features()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_last_layer_features_selected_atoms"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_last_layer_features_selected_atoms()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_multispherical"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_multispherical()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_scalar"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_scalar()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_scalar_invariant"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_scalar_invariant()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_spherical"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_spherical()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_spherical_equivariant_inversion"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_spherical_equivariant_inversion()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_spherical_equivariant_rotations"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_spherical_equivariant_rotations()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_output_vector"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_output_vector()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_prediction_energy_subset_atoms"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_prediction_energy_subset_atoms()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_prediction_energy_subset_elements"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_prediction_energy_subset_elements()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.OutputTests.test_single_atom"><code class="docutils literal notranslate"><span class="pre">OutputTests.test_single_atom()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#metatrain.utils.testing.TorchscriptTests"><code class="docutils literal notranslate"><span class="pre">TorchscriptTests</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.TorchscriptTests.float_hypers"><code class="docutils literal notranslate"><span class="pre">TorchscriptTests.float_hypers</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TorchscriptTests.jit_compile"><code class="docutils literal notranslate"><span class="pre">TorchscriptTests.jit_compile()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript"><code class="docutils literal notranslate"><span class="pre">TorchscriptTests.test_torchscript()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript_dtypechange"><code class="docutils literal notranslate"><span class="pre">TorchscriptTests.test_torchscript_dtypechange()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript_integers"><code class="docutils literal notranslate"><span class="pre">TorchscriptTests.test_torchscript_integers()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript_save_load"><code class="docutils literal notranslate"><span class="pre">TorchscriptTests.test_torchscript_save_load()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TorchscriptTests.test_torchscript_spherical"><code class="docutils literal notranslate"><span class="pre">TorchscriptTests.test_torchscript_spherical()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#metatrain.utils.testing.TrainingTests"><code class="docutils literal notranslate"><span class="pre">TrainingTests</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.testing.TrainingTests.check_gradients"><code class="docutils literal notranslate"><span class="pre">TrainingTests.check_gradients</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TrainingTests.test_continue"><code class="docutils literal notranslate"><span class="pre">TrainingTests.test_continue()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TrainingTests.test_continue_finetune_num_epochs"><code class="docutils literal notranslate"><span class="pre">TrainingTests.test_continue_finetune_num_epochs()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.testing.TrainingTests.test_continue_restart_num_epochs"><code class="docutils literal notranslate"><span class="pre">TrainingTests.test_continue_restart_num_epochs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=1afdfbfd"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/toggleprompt.js?v=5801b3bb"></script>
    </body>
</html>