<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Dataset Information" href="dataset-information.html" /><link rel="prev" title="Life Cycle of an Architecture" href="architecture-life-cycle.html" />
        <link rel="prefetch" href="../_static/images/metatrain-horizontal.png" as="image" />
        <link rel="prefetch" href="../_static/images/metatrain-horizontal-dark.png" as="image" />

    <link rel="shortcut icon" href="../_static/metatrain-64.png"/><!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>Adding a new architecture - metatrain 2025.9.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">metatrain 2025.9.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/images/metatrain-horizontal.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/images/metatrain-horizontal-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Getting started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html#shell-completion">Shell Completion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/basic_usage/usage.html">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/custom_dataset_conf.html">Customize a Dataset Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/advanced_base_config.html">Advanced Base Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/override.html">Override Architecture’s Default Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/checkpoints.html">Checkpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/units.html">Units</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../architectures/index.html">Available Architectures</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Available Architectures</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../architectures/deprecated-pet.html">PET (deprecated)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architectures/gap.html">GAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architectures/nanopet.html">NanoPET (experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architectures/pet.html">PET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architectures/soap-bpnn.html">SOAP-BPNN</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/ase/run_ase.html">Running molecular dynamics with ASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/zbl/dimers.html">Training a model with ZBL corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/programmatic/llpr/llpr.html">Computing LLPR uncertainties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/programmatic/use_architectures_outside/use_outside.html">Using metatrain architectures outside of metatrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/programmatic/disk_dataset/disk_dataset.html">Saving a disk dataset</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced-concepts/index.html">Advanced concepts</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Advanced concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/output-naming.html">Output naming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/auxiliary-outputs.html">Auxiliary outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/multi-gpu.html">Multi-GPU training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/auto-restarting.html">Automatic restarting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/fine-tuning.html">Fine-tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/fitting-generic-targets.html">Fitting generic targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-concepts/transfer-learning.html">Transfer Learning (experimental)</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Developer documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Developer documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting-started.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture-life-cycle.html">Life Cycle of an Architecture</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Adding a new architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataset-information.html">Dataset Information</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="cli/index.html">CLI API</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of CLI API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="cli/train.html">Train</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli/eval.html">Eval</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli/export.html">Export</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli/formatter.html">Formatter</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="utils/index.html">Utility API</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Utility API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="utils/additive/index.html">Additive models</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Additive models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="utils/additive/remove_additive.html">Removing additive contributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils/additive/composition.html">Composition model</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils/additive/zbl.html">ZBL short-range potential</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="utils/data/index.html">Data</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Data</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="utils/data/combine_dataloaders.html">Combining dataloaders</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils/data/dataset.html">Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils/data/get_dataset.html">Reading a dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils/data/readers.html">Readers</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils/data/writers.html">Target data Writers</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils/data/systems_to_ase.html">Converting Systems to ASE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utils/architectures.html">Architectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/augmentation.html">Augmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/devices.html">Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/dtype.html">Dtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/errors.html">Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/evaluate_model.html">Evaluating a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/external_naming.html">External Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/io.html">IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/jsonschema.html">Jsonschema</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/logging.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/long_range.html">Long-range</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/loss.html">Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/metrics.html">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/neighbor_lists.html">Neighbor lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/omegaconf.html">Custom omegaconf functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/output_gradient.html">Output gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/per_atom.html">Averaging predictions per atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/scaler.html">Scaler</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/sum_over_atoms.html">Summing over atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/transfer.html">Data type and device transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils/units.html">Unit handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/dev-docs/new-architecture.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="adding-a-new-architecture">
<span id="adding-new-architecture"></span><h1>Adding a new architecture<a class="headerlink" href="#adding-a-new-architecture" title="Link to this heading">¶</a></h1>
<p>This page describes the required classes and files necessary for adding a new
architecture to <code class="docutils literal notranslate"><span class="pre">metatrain</span></code> as experimental or stable architecture as
described on the <a class="reference internal" href="architecture-life-cycle.html#architecture-life-cycle"><span class="std std-ref">Life Cycle of an Architecture</span></a> page.</p>
<p>To work with <code class="docutils literal notranslate"><span class="pre">metatrain</span></code> any architecture has to follow the same public API to
be called correctly within the <a class="reference internal" href="cli/train.html#module-metatrain.cli.train" title="metatrain.cli.train"><code class="xref py py-func docutils literal notranslate"><span class="pre">metatrain.cli.train()</span></code></a> function to
process the user’s options. In brief, the core of the <code class="docutils literal notranslate"><span class="pre">train</span></code> function looks
similar to these lines</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">architecture</span><span class="w"> </span><span class="kn">import</span> <span class="n">__model__</span> <span class="k">as</span> <span class="n">Model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">architecture</span><span class="w"> </span><span class="kn">import</span> <span class="n">__trainer__</span> <span class="k">as</span> <span class="n">Trainer</span>

<span class="n">hypers</span> <span class="o">=</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="n">dataset_info</span> <span class="o">=</span> <span class="n">DatasetInfo</span><span class="p">()</span>

<span class="k">if</span> <span class="n">checkpoint_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">)</span>

    <span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span>
        <span class="n">checkpoint</span><span class="p">,</span> <span class="n">hypers</span><span class="o">=</span><span class="n">hypers</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">],</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;restart&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;restart&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">restart</span><span class="p">(</span><span class="n">dataset_info</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">hypers</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">])</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">hypers</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">],</span> <span class="s2">&quot;finetune&quot;</span><span class="p">):</span>
        <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">hypers</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">][</span><span class="s2">&quot;finetune&quot;</span><span class="p">][</span><span class="s2">&quot;read_from&quot;</span><span class="p">]</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">checkpoint</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;finetune&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">hypers</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">],</span> <span class="n">dataset_info</span><span class="p">)</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
    <span class="n">devices</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">train_datasets</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">val_datasets</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">checkpoint_dir</span><span class="o">=</span><span class="s2">&quot;path&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">save_checkpoint</span><span class="p">(</span><span class="s2">&quot;model.ckpt&quot;</span><span class="p">)</span>

<span class="n">mts_atomistic_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">export</span><span class="p">()</span>
<span class="n">mts_atomistic_model</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;model.pt&quot;</span><span class="p">,</span> <span class="n">collect_extensions</span><span class="o">=</span><span class="s2">&quot;extensions/&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To follow this, a new architecture has to define two classes</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">Model</span></code> class, defining the core of the architecture. This class must
implement the interface documented below in
<a class="reference internal" href="#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">metatrain.utils.abc.ModelInterface</span></code></a></p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">Trainer</span></code> class, used to train an architecture and produce a model that
can be evaluated and exported. This class must implement the interface
documented below in <a class="reference internal" href="#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">metatrain.utils.abc.TrainerInterface</span></code></a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">metatrain</span></code> does not know the types and numbers of targets/datasets an
architecture can handle. As a result, it cannot generate useful error
messages when a user attempts to train an architecture with unsupported
target and dataset combinations. Therefore, it is the responsibility of the
architecture developer to verify if the model and the trainer support the
provided train_datasets and val_datasets passed to the Trainer, as well as
the dataset_info passed to the model.</p>
</div>
<p>To comply with this design each architecture has to implement a couple of files
inside a new architecture directory, either inside the <code class="docutils literal notranslate"><span class="pre">experimental</span></code>
subdirectory or in the <code class="docutils literal notranslate"><span class="pre">root</span></code> of the Python source if the new architecture
already complies with all requirements to be stable. The usual structure of
architecture looks as</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>myarchitecture
    ├── model.py
    ├── trainer.py
    ├── __init__.py
    ├── default-hypers.yaml
    └── schema-hypers.json
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A new architecture doesn’t have to be registered somewhere in the file tree
of <code class="docutils literal notranslate"><span class="pre">metatrain</span></code>. Once a new architecture folder with the required files is
created <code class="docutils literal notranslate"><span class="pre">metatrain</span></code> will include the architecture automatically.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because achitectures can live in either <code class="docutils literal notranslate"><span class="pre">src/metatrain/&lt;architecture&gt;</span></code>,
<code class="docutils literal notranslate"><span class="pre">src/metatrain/experimental/&lt;architecture&gt;</span></code>, or
<code class="docutils literal notranslate"><span class="pre">src/metatrain/deprecated/&lt;architecture&gt;</span></code>; the code inside should use
absolute imports use the tools provided by metatrain.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># do not do this</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..utils.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">dtype_to_str</span>

<span class="c1"># Do this instead</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">metatrain.utils.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">dtype_to_str</span>
</pre></div>
</div>
</div>
<section id="model-class-model-py">
<h2>Model class (<code class="docutils literal notranslate"><span class="pre">model.py</span></code>)<a class="headerlink" href="#model-class-model-py" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.abc.</span></span><span class="sig-name descname"><span class="pre">ModelInterface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils/data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/metadata.html#metatomic.torch.ModelMetadata" title="(in metatomic)"><span class="pre">ModelMetadata</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#ModelInterface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.ModelInterface" title="Link to this definition">¶</a></dt>
<dd><p>Abstract base class for a machine learning model in metatrain.</p>
<p>All architectures in metatrain must be implemented as sub-class of this class,
and implement the corresponding methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>)</p></li>
<li><p><strong>dataset_info</strong> (<a class="reference internal" href="utils/data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>)</p></li>
<li><p><strong>metadata</strong> (<a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/metadata.html#metatomic.torch.ModelMetadata" title="(in metatomic)"><em>ModelMetadata</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.hypers">
<span class="sig-name descname"><span class="pre">hypers</span></span><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.hypers" title="Link to this definition">¶</a></dt>
<dd><p>The model hyper passed at initialization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.dataset_info">
<span class="sig-name descname"><span class="pre">dataset_info</span></span><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.dataset_info" title="Link to this definition">¶</a></dt>
<dd><p>The dataset info passed at initialization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.metadata" title="Link to this definition">¶</a></dt>
<dd><p>The metadata passed at initialization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.forward">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">systems</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/systems.html#metatomic.torch.System" title="(in metatomic)"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/metadata.html#metatomic.torch.ModelOutput" title="(in metatomic)"><span class="pre">ModelOutput</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.metatensor.org/latest/torch/reference/labels.html#metatensor.torch.Labels" title="(in metatensor)"><span class="pre">Labels</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.metatensor.org/latest/torch/reference/tensor.html#metatensor.torch.TensorMap" title="(in metatensor)"><span class="pre">TensorMap</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#ModelInterface.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.forward" title="Link to this definition">¶</a></dt>
<dd><p>Execute the model for the given <code class="docutils literal notranslate"><span class="pre">systems</span></code>, computing the requested
<code class="docutils literal notranslate"><span class="pre">outputs</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/export.html#metatomic.torch.ModelInterface" title="(in metatomic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">metatomic.torch.ModelInterface</span></code></a> for more explanation about the
different arguments.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>systems</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/systems.html#metatomic.torch.System" title="(in metatomic)"><em>System</em></a><em>]</em>)</p></li>
<li><p><strong>outputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/metadata.html#metatomic.torch.ModelOutput" title="(in metatomic)"><em>ModelOutput</em></a><em>]</em>)</p></li>
<li><p><strong>selected_atoms</strong> (<a class="reference external" href="https://docs.metatensor.org/latest/torch/reference/labels.html#metatensor.torch.Labels" title="(in metatensor)"><em>Labels</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <a class="reference external" href="https://docs.metatensor.org/latest/torch/reference/tensor.html#metatensor.torch.TensorMap" title="(in metatensor)"><em>TensorMap</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.supported_outputs">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supported_outputs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/metadata.html#metatomic.torch.ModelOutput" title="(in metatomic)"><span class="pre">ModelOutput</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#ModelInterface.supported_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.supported_outputs" title="Link to this definition">¶</a></dt>
<dd><p>Get the outputs currently supported by this model.</p>
<p>This will likely be the same outputs that are set as this model capabilities in
<a class="reference internal" href="#metatrain.utils.abc.ModelInterface.export" title="metatrain.utils.abc.ModelInterface.export"><code class="xref py py-func docutils literal notranslate"><span class="pre">ModelInterface.export()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/metadata.html#metatomic.torch.ModelOutput" title="(in metatomic)"><em>ModelOutput</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.restart">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">restart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils/data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><span class="pre">DatasetInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><span class="pre">ModelInterface</span></a></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#ModelInterface.restart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.restart" title="Link to this definition">¶</a></dt>
<dd><p>Update a model to restart training, potentially with different dataset and/or
targets.</p>
<p>This function is called whenever training restarts, with the same or a different
dataset. It enables transfer learning (changing the targets), and fine-tuning
(same targets, different datasets)</p>
<p>This function should return the updated model, or a new instance of the model
able to handle the new dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset_info</strong> (<a class="reference internal" href="utils/data/dataset.html#metatrain.utils.data.dataset.DatasetInfo" title="metatrain.utils.data.dataset.DatasetInfo"><em>DatasetInfo</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><em>ModelInterface</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.load_checkpoint">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'restart'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'finetune'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'export'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><span class="pre">ModelInterface</span></a></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#ModelInterface.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.load_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Create a model from a checkpoint (i.e. state dictionary).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>) – Checkpoint’s state dictionary.</p></li>
<li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'restart'</em><em>, </em><em>'finetune'</em><em>, </em><em>'export'</em><em>]</em>) – Context in which to load the model. Possible values are
<code class="docutils literal notranslate"><span class="pre">&quot;restart&quot;</span></code> when restarting a stopped traininf run, <code class="docutils literal notranslate"><span class="pre">&quot;finetune&quot;</span></code> when
loading a model for further fine-tuning or transfer learning, and
<code class="docutils literal notranslate"><span class="pre">&quot;export&quot;</span></code> when loading a model for final export. When multiple
checkpoints are stored together, this can be used to pick one of them
depending on the context.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><em>ModelInterface</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.export">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/metadata.html#metatomic.torch.ModelMetadata" title="(in metatomic)"><span class="pre">ModelMetadata</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/export.html#metatomic.torch.AtomisticModel" title="(in metatomic)"><span class="pre">AtomisticModel</span></a></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#ModelInterface.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.export" title="Link to this definition">¶</a></dt>
<dd><p>Turn this model into an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">metatomic.torch.MetatensorAtomisticModel</span></code>, containing the model
itself, a definition of the model capabilities and some metadata about the
model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metadata</strong> (<a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/metadata.html#metatomic.torch.ModelMetadata" title="(in metatomic)"><em>ModelMetadata</em></a><em> | </em><em>None</em>) – additional metadata to add in the model as specified by the
user.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.metatensor.org/metatomic/latest/torch/reference/models/export.html#metatomic.torch.AtomisticModel" title="(in metatomic)"><em>AtomisticModel</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.upgrade_checkpoint">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">upgrade_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#ModelInterface.upgrade_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.upgrade_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Upgrade the checkpoint to the current version of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if the checkpoint cannot be upgraded to the current
version of the model.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.ModelInterface.get_checkpoint">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_checkpoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#ModelInterface.get_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.ModelInterface.get_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Get the checkpoint of the model. This should contain all the information
needed by <cite>load_checkpoint</cite> to recreate the same model instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p>Defining a new model can then be done as follow;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metatomic.torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelMetadata</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">metatrain.utils.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelInterface</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyModel</span><span class="p">(</span><span class="n">ModelInterface</span><span class="p">):</span>

    <span class="n">__checkpoint_version__</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">__supported_devices__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span> <span class="s2">&quot;cpu&quot;</span><span class="p">]</span>
    <span class="n">__supported_dtypes__</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
    <span class="n">__default_metadata__</span> <span class="o">=</span> <span class="n">ModelMetadata</span><span class="p">(</span>
        <span class="n">references</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;implementation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ref1&quot;</span><span class="p">],</span> <span class="s2">&quot;architecture&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ref2&quot;</span><span class="p">]}</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hypers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">dataset_info</span><span class="p">:</span> <span class="n">DatasetInfo</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">hypers</span><span class="p">,</span> <span class="n">dataset_info</span><span class="p">)</span>
        <span class="o">...</span>

    <span class="o">...</span> <span class="c1"># implementation of all the functions from ModelInterface</span>
</pre></div>
</div>
<p>In addition to subclassing <code class="docutils literal notranslate"><span class="pre">ModelInterface</span></code>, the model class should have the
following class attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__supported_devices__</span></code> list of the suported torch devices for running the
model;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__supported_dtypes__</span></code> list of the supported dtype for this model;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__default_metadata__</span></code> can be used to provide references that will be
stored in the exported model. The references are stored in a dictionary with
keys <code class="docutils literal notranslate"><span class="pre">implementation</span></code> and <code class="docutils literal notranslate"><span class="pre">architecture</span></code>. The <code class="docutils literal notranslate"><span class="pre">implementation</span></code> key
should contain references to the software used in the implementation of the
architecture, while the <code class="docutils literal notranslate"><span class="pre">architecture</span></code> key should contain references about
the general architecture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__checkpoint_version__</span></code> stores the current version of the checkpoint, used
to upgrade checkpoints produced with earlier versions of the code. See
<a class="reference internal" href="#ckpt-version"><span class="std std-ref">Checkpoint versioning</span></a> for more information.</p></li>
</ul>
<p>Both <code class="docutils literal notranslate"><span class="pre">__supported_devices__</span></code> and <code class="docutils literal notranslate"><span class="pre">__supported_dtypes__</span></code> should be sorted in
order of preference since <code class="docutils literal notranslate"><span class="pre">metatrain</span></code> will use these to determine, based on
the user request and machines’ availability, the optimal <code class="docutils literal notranslate"><span class="pre">dtype</span></code> and
<code class="docutils literal notranslate"><span class="pre">device</span></code> for training.</p>
</section>
<section id="trainer-class-trainer-py">
<h2>Trainer class (<code class="docutils literal notranslate"><span class="pre">trainer.py</span></code>)<a class="headerlink" href="#trainer-class-trainer-py" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="metatrain.utils.abc.TrainerInterface">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">metatrain.utils.abc.</span></span><span class="sig-name descname"><span class="pre">TrainerInterface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hypers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#TrainerInterface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.TrainerInterface" title="Link to this definition">¶</a></dt>
<dd><p>Abstract base class for a model trainer in metatrain.</p>
<p>All architectures in metatrain must implement such a trainer, which is responsible
for training the model. The trainer must be a be sub-class of this class, and
implement the corresponding methods.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="metatrain.utils.abc.TrainerInterface.hypers">
<span class="sig-name descname"><span class="pre">hypers</span></span><a class="headerlink" href="#metatrain.utils.abc.TrainerInterface.hypers" title="Link to this definition">¶</a></dt>
<dd><p>The trainer hypers passed at intialization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.TrainerInterface.train">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><span class="pre">ModelInterface</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.8)"><span class="pre">dtype</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">devices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><span class="pre">device</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_datasets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.metatensor.org/latest/learn/reference/data/index.html#metatensor.learn.Dataset" title="(in metatensor)"><span class="pre">Dataset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Subset" title="(in PyTorch v2.8)"><span class="pre">Subset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_datasets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.metatensor.org/latest/learn/reference/data/index.html#metatensor.learn.Dataset" title="(in metatensor)"><span class="pre">Dataset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Subset" title="(in PyTorch v2.8)"><span class="pre">Subset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#TrainerInterface.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.TrainerInterface.train" title="Link to this definition">¶</a></dt>
<dd><p>Train the <code class="docutils literal notranslate"><span class="pre">model</span></code> using the <code class="docutils literal notranslate"><span class="pre">train_datasets</span></code>. How to train the model is left
to this class, using the hyper-parameter given in <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#metatrain.utils.abc.ModelInterface" title="metatrain.utils.abc.ModelInterface"><em>ModelInterface</em></a>) – the model to train</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.8)"><em>dtype</em></a>) – <code class="docutils literal notranslate"><span class="pre">torch.dtype</span></code> used by the data in the datasets</p></li>
<li><p><strong>devices</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><em>device</em></a><em>]</em>) – <code class="docutils literal notranslate"><span class="pre">torch.device</span></code> to use for training the model. When training
with more than one device (e.g. multi-GPU training), this can contains
multiple devices.</p></li>
<li><p><strong>train_datasets</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.metatensor.org/latest/learn/reference/data/index.html#metatensor.learn.Dataset" title="(in metatensor)"><em>Dataset</em></a><em> | </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Subset" title="(in PyTorch v2.8)"><em>Subset</em></a><em>]</em>) – datasets to use to train the model</p></li>
<li><p><strong>val_datasets</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.metatensor.org/latest/learn/reference/data/index.html#metatensor.learn.Dataset" title="(in metatensor)"><em>Dataset</em></a><em> | </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.Subset" title="(in PyTorch v2.8)"><em>Subset</em></a><em>]</em>) – datasets to use for model validation</p></li>
<li><p><strong>checkpoint_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – directory where checkpoints shoudl be saved</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.TrainerInterface.save_checkpoint">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#TrainerInterface.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.TrainerInterface.save_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Save a checkoint of both the <code class="docutils literal notranslate"><span class="pre">model</span></code> and trainer state to the given <code class="docutils literal notranslate"><span class="pre">path</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.TrainerInterface.upgrade_checkpoint">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">upgrade_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#TrainerInterface.upgrade_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.TrainerInterface.upgrade_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Upgrade the checkpoint to the current version of the trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if the checkpoint cannot be upgraded to the current
version of the trainer.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="metatrain.utils.abc.TrainerInterface.load_checkpoint">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hypers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'restart'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'finetune'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><span class="pre">TrainerInterface</span></a></span></span><a class="reference internal" href="../_modules/metatrain/utils/abc.html#TrainerInterface.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#metatrain.utils.abc.TrainerInterface.load_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Create a trainer instance from data stored in the <code class="docutils literal notranslate"><span class="pre">checkpoint</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>) – Checkpoint’s state dictionary.</p></li>
<li><p><strong>hypers</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>) – Hyper-parameters for the trainer, as specified by the user.</p></li>
<li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'restart'</em><em>, </em><em>'finetune'</em><em>]</em>) – Context in which to load the model. Possible values are
<code class="docutils literal notranslate"><span class="pre">&quot;restart&quot;</span></code> when restarting a stopped traininf run, and <code class="docutils literal notranslate"><span class="pre">&quot;finetune&quot;</span></code>
when loading a model for further fine-tuning or transfer learning. When
multiple checkpoints are stored together, this can be used to pick one of
them depending on the context.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#metatrain.utils.abc.TrainerInterface" title="metatrain.utils.abc.TrainerInterface"><em>TrainerInterface</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p>Defining a new trainer can then be done as like this;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metatrain.utils.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainerInterface</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyTrainer</span><span class="p">(</span><span class="n">TrainerInterface</span><span class="p">):</span>

    <span class="n">__checkpoint_version__</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_hypers</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="o">...</span> <span class="c1"># implementation of all the functions from TrainerInterface</span>
</pre></div>
</div>
</section>
<section id="init-file-init-py">
<h2>Init file (<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>)<a class="headerlink" href="#init-file-init-py" title="Link to this heading">¶</a></h2>
<p>You are free to name the <code class="docutils literal notranslate"><span class="pre">Model</span></code> and <code class="docutils literal notranslate"><span class="pre">Trainer</span></code> classes as you want. These
classes should then be made available in the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> under the names
<code class="docutils literal notranslate"><span class="pre">__model__</span></code> and <code class="docutils literal notranslate"><span class="pre">__trainer__</span></code> so metatrain knows where to find them.
<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> must also contain definition for the original <code class="docutils literal notranslate"><span class="pre">__authors__</span></code>
and current <code class="docutils literal notranslate"><span class="pre">__maintainers__</span></code> of the architecture.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelInterface</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.trainer</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainerInterface</span>

<span class="c1"># class to use as the architecture&#39;s model</span>
<span class="n">__model__</span> <span class="o">=</span> <span class="n">ModelInterface</span>
<span class="c1"># class to use as the architecture&#39;s trainer</span>
<span class="n">__trainer__</span> <span class="o">=</span> <span class="n">TrainerInterface</span>

<span class="c1"># List of the original authors of the architecture, each with an email</span>
<span class="c1"># address and GitHub handle.</span>
<span class="c1">#</span>
<span class="c1"># These authors are not necessarily currently in charge of maintaining the code</span>
<span class="n">__authors__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Jane Roe &lt;jane.roe@myuniversity.org&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;@janeroe&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;John Doe &lt;john.doe@otheruniversity.edu&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;@johndoe&quot;</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Current maintainers of the architecture code, using the same</span>
<span class="c1"># style as ``__authors__``</span>
<span class="n">__maintainers__</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Joe Bloggs &lt;joe.bloggs@sotacompany.com&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;@joebloggs&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</section>
<section id="default-hyperparamers-default-hypers-yaml">
<h2>Default Hyperparamers (<code class="docutils literal notranslate"><span class="pre">default-hypers.yaml</span></code>)<a class="headerlink" href="#default-hyperparamers-default-hypers-yaml" title="Link to this heading">¶</a></h2>
<p>The default hyperparameters for each architecture should be stored in a YAML
file <code class="docutils literal notranslate"><span class="pre">default-hypers.yaml</span></code> inside the architecture directory. Reasonable
default hypers are required to improve usability. The default hypers must follow
the structure</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myarchitecture</span>

<span class="nt">model</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="nt">training</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">metatrain</span></code> will parse this file and overwrite these default hypers with the
user-provided parameters and pass the merged <code class="docutils literal notranslate"><span class="pre">model</span></code> section as a Python
dictionary to the <code class="docutils literal notranslate"><span class="pre">ModelInterface</span></code> and the <code class="docutils literal notranslate"><span class="pre">training</span></code> section to the
<code class="docutils literal notranslate"><span class="pre">TrainerInterface</span></code>.</p>
<section id="finetuning">
<h3>Finetuning<a class="headerlink" href="#finetuning" title="Link to this heading">¶</a></h3>
<p>If your architecture is supporting finetuning you have to add a <code class="docutils literal notranslate"><span class="pre">finetune</span></code> subsection
in the <code class="docutils literal notranslate"><span class="pre">training</span></code> section. The subsection must contain a <code class="docutils literal notranslate"><span class="pre">read_from</span></code> key that points
to the checkpoint file the finetuning is started from. Any additional hyperparameters
can be architecture specific.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">training</span><span class="p">:</span>
<span class="w">    </span><span class="nt">finetune</span><span class="p">:</span>
<span class="w">        </span><span class="nt">read_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/checkpoint.ckpt</span>
<span class="w">        </span><span class="c1"># other architecture finetune hyperparameters</span>
</pre></div>
</div>
</section>
</section>
<section id="json-schema-schema-hypers-yaml">
<h2>JSON schema (<code class="docutils literal notranslate"><span class="pre">schema-hypers.yaml</span></code>)<a class="headerlink" href="#json-schema-schema-hypers-yaml" title="Link to this heading">¶</a></h2>
<p>To validate the user’s input hyperparameters we are using <a class="reference external" href="https://json-schema.org/">JSON schemas</a> stored in a schema file called
<code class="docutils literal notranslate"><span class="pre">schema-hypers.json</span></code>. For an <a class="reference internal" href="architecture-life-cycle.html#architecture-life-cycle"><span class="std std-ref">experimental architecture</span></a> it is not required to provide such a schema along
with its default hypers but it is highly recommended to reduce possible errors
of user input like typos in parameter names or wrong sections. If no
<code class="docutils literal notranslate"><span class="pre">schema-hypers.json</span></code> is provided no validation is performed and user hypers
are passed to the architecture model and trainer as is.</p>
<p>To create such a schema you can try using <a class="reference external" href="https://jsonformatter.org">online tools</a> that convert the <code class="docutils literal notranslate"><span class="pre">default-hypers.yaml</span></code> into a
JSON schema. Besides online tools, we also had success using ChatGPT/LLM for
this for conversion.</p>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">¶</a></h2>
<p>Each new architecture should be added to <code class="docutils literal notranslate"><span class="pre">metatrain</span></code>’s documentation. A short
page describing the architecture and its default hyperparameters will be
sufficient. You can take inspiration from existing architectures. The various
targets that the architecture can fit should be added to the table in the
“Fitting generic targets” section.</p>
</section>
<section id="checkpoint-versioning">
<span id="ckpt-version"></span><h2>Checkpoint versioning<a class="headerlink" href="#checkpoint-versioning" title="Link to this heading">¶</a></h2>
<p>Checkpoints are used to save the weights of a models and the state of the
trainer to disk, enabling to restart interupted training runs, to fine-tune
existing models on new dataset, and to export standalone models based on
TorchScript.</p>
<p>A checkpoint created for one version might need to be read again
by a later version of the architecture, where the internal structure might have
changed. To enable this, all <code class="docutils literal notranslate"><span class="pre">Model</span></code> classes are required to have a
<code class="docutils literal notranslate"><span class="pre">__checkpoint_version__</span></code> class attribute containing the version of the
checkoint, as a strictly inreasing integer. Additionally, architectures should
provide an <code class="docutils literal notranslate"><span class="pre">upgrade_checkpoint(checkpoint:</span> <span class="pre">Dict)</span> <span class="pre">-&gt;</span> <span class="pre">Dict</span></code> function, that will
be called when a user is trying to load some outdated checkpoint. This function
is responsible for updating the checkpoint data and returning a checkpoint
compatible with the current version.</p>
<p>Similarly, the <code class="docutils literal notranslate"><span class="pre">Trainer</span></code> state is also saved in checkpoint and used to restart
training. All trainer must thus have a <code class="docutils literal notranslate"><span class="pre">__checkpoint_version__</span></code> class
attribute as well as a <code class="docutils literal notranslate"><span class="pre">upgrade_checkpoint(checkpoint:</span> <span class="pre">Dict)</span> <span class="pre">-&gt;</span> <span class="pre">Dict</span></code> function
to updgrade from previous checkpoints.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="dataset-information.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Dataset Information</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="architecture-life-cycle.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Life Cycle of an Architecture</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, metatrain developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-github fa-2x" href="https://github.com/metatensor/metatrain" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Adding a new architecture</a><ul>
<li><a class="reference internal" href="#model-class-model-py">Model class (<code class="docutils literal notranslate"><span class="pre">model.py</span></code>)</a><ul>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface"><code class="docutils literal notranslate"><span class="pre">ModelInterface</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.hypers"><code class="docutils literal notranslate"><span class="pre">ModelInterface.hypers</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.dataset_info"><code class="docutils literal notranslate"><span class="pre">ModelInterface.dataset_info</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.metadata"><code class="docutils literal notranslate"><span class="pre">ModelInterface.metadata</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.forward"><code class="docutils literal notranslate"><span class="pre">ModelInterface.forward()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.supported_outputs"><code class="docutils literal notranslate"><span class="pre">ModelInterface.supported_outputs()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.restart"><code class="docutils literal notranslate"><span class="pre">ModelInterface.restart()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">ModelInterface.load_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.export"><code class="docutils literal notranslate"><span class="pre">ModelInterface.export()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.upgrade_checkpoint"><code class="docutils literal notranslate"><span class="pre">ModelInterface.upgrade_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.ModelInterface.get_checkpoint"><code class="docutils literal notranslate"><span class="pre">ModelInterface.get_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#trainer-class-trainer-py">Trainer class (<code class="docutils literal notranslate"><span class="pre">trainer.py</span></code>)</a><ul>
<li><a class="reference internal" href="#metatrain.utils.abc.TrainerInterface"><code class="docutils literal notranslate"><span class="pre">TrainerInterface</span></code></a><ul>
<li><a class="reference internal" href="#metatrain.utils.abc.TrainerInterface.hypers"><code class="docutils literal notranslate"><span class="pre">TrainerInterface.hypers</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.TrainerInterface.train"><code class="docutils literal notranslate"><span class="pre">TrainerInterface.train()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.TrainerInterface.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">TrainerInterface.save_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.TrainerInterface.upgrade_checkpoint"><code class="docutils literal notranslate"><span class="pre">TrainerInterface.upgrade_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#metatrain.utils.abc.TrainerInterface.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">TrainerInterface.load_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#init-file-init-py">Init file (<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>)</a></li>
<li><a class="reference internal" href="#default-hyperparamers-default-hypers-yaml">Default Hyperparamers (<code class="docutils literal notranslate"><span class="pre">default-hypers.yaml</span></code>)</a><ul>
<li><a class="reference internal" href="#finetuning">Finetuning</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-schema-schema-hypers-yaml">JSON schema (<code class="docutils literal notranslate"><span class="pre">schema-hypers.yaml</span></code>)</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#checkpoint-versioning">Checkpoint versioning</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=f9c70d97"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/toggleprompt.js?v=5801b3bb"></script>
    </body>
</html>